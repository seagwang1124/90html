<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>통큰통독-90일차</title>
  <link rel="apple-touch-icon" type="image/png" href="https://i.postimg.cc/Qtnq0gFJ/Ezra-icon.png">
  <meta name="apple-mobile-web-app-title" content="통큰통독">
  <link rel="shortcut icon" type="image/png" href="https://i.postimg.cc/Qtnq0gFJ/Ezra-icon.png">
  <link rel="mask-icon" type="image/png" href="https://i.postimg.cc/Qtnq0gFJ/Ezra-icon.png">

  <style>
    :root{
      --blue:#007BFF;
      --pink:#ff99cc;
      --shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html,body { height:100%; margin:0; padding:0; font-family: Arial, sans-serif; -webkit-font-smoothing:antialiased; }
    body { padding-top:150px; background:#fdfdf8; color:#222; }

    a:link { color:#0000FF; } a:visited{ color:#660099; }

    /* 상단 고정 테이블 */
    .top-fixed-table {
      position: fixed; top:0; left:0; width:100%; background:transparent; border-bottom:none; z-index:100;
      table-layout: fixed; padding:10px 0; box-sizing:border-box;
    }
    .search-cell { text-align:left; padding-left:10px; vertical-align:top; width:30%; }
    .search-cell input[type="text"]{ width:50%; font-size:12pt; }
    .search-cell input[type="submit"], .search-cell input[type="reset"]{ font-size:10pt; padding:5px 8px; height:auto; }

    .audio-cell { text-align:right; padding-right:50px; vertical-align:top; width:30%; }
    #custom-audio-player { display:flex; flex-direction:column; align-items:center; }
    .player-controls{ display:flex; align-items:center; justify-content:center; gap:10px; margin-bottom:5px; }
    .time-display{ font-size:16px; font-weight:bold; color:black; margin:0 5px; min-width:44px; text-align:center; }

    .progress-container { display: flex; align-items: center; justify-content: center; gap: 6px; margin: 6px 0; }
    .skip-btn { width: 48px; height: 28px; font-size: 13px; cursor: pointer; border: 1px solid #ccc; border-radius: 5px; background: #fff; }
    .skip-btn:hover { background: #e0e0e0; }

    .control-btn{ width:28px; height:28px; font-size:14px; cursor:pointer; border:1px solid #ccc; background:#fff; border-radius:5px; }
    .control-btn:hover{ background:#e0e0e0; }
    #play-btn{ background:#d1f3d4; } #pause-btn{ background:#fff6d6; } #stop-btn{ background:#fddddd; }

    .speed-controls{ display:flex; align-items:center; justify-content:center; gap:5px; margin-bottom:5px; }
    .speed-btn{ width:21px; height:21px; font-size:10px; cursor:pointer; border:1px solid #ccc; border-radius:3px; background:#fff; }
    .speed-btn:hover{ background:#e0e0e0; }
    .speed-display{ font-weight:bold; color:var(--blue); width:50px; text-align:center; }

    .volume-control{ display:flex; align-items:center; justify-content:center; gap:5px; }
    input[type="range"]{ -webkit-appearance:none; width:160px; height:5px; background:#d3d3d3; outline:none; opacity:0.9; transition:opacity .2s; border-radius:3px;}
    input[type="range"]::-webkit-slider-thumb{ -webkit-appearance:none; appearance:none; width:15px; height:15px; background:var(--blue); border-radius:50%; cursor:pointer; }

    /* progress */
    #progress-bar { width: 60%; max-width: 100px; }

    /* volume */
    #volume-slider { width: 80%; max-width: 120px; }

    /* 설명 버튼 컨테이너 (플로팅) */
    .explanation-button-container{ position:fixed; top:100px; left:30%;  transform:translateX(-50%);  padding:0 10px; transition:top .2s ease,left .2s ease,transform .2s ease; }
    .explanation-button-wrapper{ position:relative; display:inline-block; cursor:pointer; }
    .explanation-icon-button{ width:50px; height:50px; border-radius:50%; background:var(--pink); box-shadow:var(--shadow); border:none; display:flex; align-items:center; justify-content:center; font-size:40px; z-index:2; }
    .explanation-sub-buttons{ display:flex; flex-direction:column; gap:10px; opacity:0; visibility:hidden; transition:opacity .3s ease,visibility .3s ease, transform .3s ease; position:absolute; left:45%; transform:translateX(-50%) translateY(25px); z-index:1; }
    .explanation-button-wrapper.active .explanation-sub-buttons{ opacity:1; visibility:visible; transform:translateX(-50%) translateY(0); }
    .explanation-sub-button{ padding:5px 10px; font-size:18px; background:var(--pink); border:none; border-radius:5px; cursor:pointer; box-shadow:var(--shadow); white-space:nowrap; }
    .explanation-sub-button:hover{ transform:scale(1.03); }

    /* 폰트 사이즈 및 본문 요약 버튼 (항상 표시) */
    .container{ width:100%; text-align:center; margin-top:8px; }
    .font-size-label{ font-size:20px !important; margin-right:12px; font-weight:bold; color:blue; display:inline-block; vertical-align:middle; }
    #font-size{ font-size:20px !important; margin:0 8px; font-weight:bold; color:red; display:inline-block; vertical-align:middle; width:48px; }
    #down,#up{ width:27px; height:27px; font-size:20px; color:red; background:#fff; border:1px solid #ccc; border-radius:5px; cursor:pointer; display:inline-block; vertical-align:middle; }

    .summary-buttons { display:inline-block; margin-left:16px; vertical-align:middle; }
    .summary-btn { padding:6px 10px; margin-left:6px; font-size:14px; border-radius:6px; border:1px solid #ccc; background:#fff; cursor:pointer; }
    .summary-btn:hover{ background:#f2f2f2; }

    /* 일차 내비게이션 */
.day-nav{
  display:flex; align-items:center; justify-content:flex-start; gap:10px;
  margin: 10px 15px 0;
}
.day-nav .day-btn{
  text-decoration:none; background:#fff; color:#333;
  padding:6px 12px; border:1px solid #ccc; border-radius:8px;
  box-shadow: var(--shadow); font-weight:700; line-height:1;
}
.day-nav .day-btn:hover{ background:#f7f7f7; }
.day-nav .day-title{
  font-weight:900; letter-spacing:.2px; color:#222;
}
@media (max-width:480px){
  .day-nav .day-title{ font-size:16px; }
  .day-nav .day-btn{ padding:6px 10px; font-size:14px; }
}

    /* 본문 */
    h2{ padding:0; text-align:left; margin-left:15px; margin-right:15px; }
    p{ display:inline-block; }

    /* 본문 중앙 두 줄 강조 */
    .highlight {
      background-color:#fdf6e3;
      -webkit-text-stroke:0.2px #76d6c6;
      border-left:4px solid #c0a060;
      font-weight:bold;
      box-shadow:0 0 8px rgba(0,0,0,0.1);
      padding:2px 6px;
    }

    /* 📖 구절설명 버튼: 기본 표시 */
    #explanation-button-container{
      position:fixed; z-index:150; display:block;
    }
    body.modal-open #explanation-button-container{ display:none !important; }

    /* 모달 */
    .modal{
      display:none; position:fixed; z-index:200; inset:0; width:100%; height:100%;
      background:rgba(0,0,0,0.4);
    }
    .modal-content{
      background:#fff; margin:12% auto; padding:20px; border-radius:10px; width:80%; max-width:900px;
      max-height:80vh; overflow:auto; overscroll-behavior:contain;
      box-shadow:0 4px 8px rgba(0,0,0,0.2); text-align:left; line-height:1.6; word-break:keep-all; white-space:pre-wrap;
    }
    body.modal-open{ overflow:hidden; }

    /* 로딩 스피너 */
    .loader{ border:4px solid #f3f3f3; border-top:4px solid #3498db; border-radius:50%; width:20px; height:20px; animation:spin 1s linear infinite; display:inline-block; vertical-align:middle; margin-right:8px; }
    @keyframes spin{ 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }

    /* 검색 하이라이트 & 스크롤 마커 */
    .search-highlight{ background:yellow; color:#000; }
    .scroll-marker-container{ position:fixed; top:0; right:0; width:8px; height:100vh; z-index:99; pointer-events:none; }
    .scroll-marker{ position:absolute; right:0; width:8px; height:8px; background:red; border-radius:50%; box-shadow:0 0 5px rgba(255,0,0,0.7); cursor:pointer; pointer-events:auto; }
    .scroll-marker:hover{ transform:scale(1.5); transition:transform .2s ease; }

    /* 선택 관련 (iOS) */
    #bible-text{ -webkit-user-select:text; user-select:text; -webkit-touch-callout:none; }

    /* 반응형 */
    @media (max-width:800px){
      .search-cell{ width:55%; } .audio-cell{ width:45%; } .search-cell input[type="text"]{ width:60%; } #progress-bar{ width:160px; }
    }
    @media (max-width:600px){
  /* 좌/우 칸 비율 + 오른쪽 패딩 확보 */
  .search-cell{ width:30%; }
  .audio-cell{ width:34%; padding-right:12px; } /* 8px → 14px */

  /* 검색창을 뷰포트 기준으로 더 줄이기 */
  .search-cell input[type="text"]{
    width:32vw;          /* 45vw → 35vw */
    max-width:32vw;
    font-size:12pt;
  }
  /* 검색 버튼들도 살짝 컴팩트 */
  .search-cell input[type="submit"],
  .search-cell input[type="reset"]{
    padding:4px 6px;
    font-size:10pt;
  }

  /* 오디오 컨트롤이 덜 퍼지도록 */
  .player-controls{ gap:6px; }           /* 10px → 6px */
  .time-display{
    font-size:14px;                       /* 16px → 14px */
    min-width:56px;                       /* 44px → 56px 로 고정폭 확보 */
  }

  #progress-bar{ width:140px; }
  .explanation-sub-button{ font-size:16px; padding:6px 8px; }
  .explanation-icon-button{ width:46px; height:46px; font-size:34px; }
  .summary-btn{ padding:5px 8px; font-size:13px; }
}

    .toggle-buttons {
      display:flex; justify-content:center; gap:8px; margin-bottom:6px;
    }
    .toggle-buttons button {
      padding:4px 8px; font-size:13px; border:1px solid #ccc; border-radius:5px; background:#fff; cursor:pointer;
    }
    .toggle-buttons button:hover { background:#f0f0f0; }

    /* ============ 기도문 팝업 ============ */
    .prayer-toast {
      position: fixed; right: 18px; bottom: 18px; z-index: 190;
      width: 360px; max-width: calc(100vw - 24px);
      background: #ffffff; border: 1px solid #e9e6d8;
      border-radius: 14px; box-shadow: 0 10px 26px rgba(0,0,0,.18);
      overflow: hidden; transform: translateY(20px); opacity: 0;
      animation: prayerSlideUp .35s ease-out forwards; display:none;
      font-family: inherit;
    }
    @keyframes prayerSlideUp { to { transform: translateY(0); opacity: 1; } }

    .prayer-header {
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px; background:#fff6dd; border-bottom:1px solid #f3e9c3;
    }
    .prayer-title { display:flex; align-items:center; gap:8px; font-weight:700; color:#8a6d1e; }
    .prayer-badge { background:#ffe9a8; color:#6b560f; font-size:12px; padding:2px 8px; border-radius:999px; }

    .prayer-close {
      border:0; background:transparent; font-size:20px; line-height:1; color:#7c7c7c;
      cursor:pointer; padding:2px 6px; border-radius:8px;
    }
    .prayer-close:hover { background: rgba(0,0,0,.05); }

    .prayer-body {
      padding:12px 14px 4px; color:#333; line-height:1.6; max-height:220px; overflow:auto;
    }
    .prayer-body h4 { margin:0 0 6px 0; font-size:15px; color:#444; }
    .prayer-body p { margin:0; white-space: pre-wrap; }

    .prayer-footer {
      display:flex; align-items:center; justify-content: space-between; gap:8px; padding:8px 12px 12px;
    }
    .prayer-actions { display:flex; gap:8px; }
    .prayer-btn {
      border:1px solid #e0dccc; background:#fff; color:#5a4d1b; padding:6px 10px; border-radius:10px; cursor:pointer; font-size:13px;
    }
    .prayer-btn:hover { background:#faf7ea; }
    .prayer-btn-primary { background:#f9d86b; border-color:#e5c458; color:#3e320e; font-weight:700; }
    .prayer-btn-primary:hover { filter: brightness(.98); }
    .prayer-checkbox { display:flex; align-items:center; gap:6px; color:#555; font-size:13px; }

    @media (max-width: 480px) {
      .prayer-toast { left:12px; right:12px; bottom:12px; width:auto; }
      .prayer-body { max-height:40vh; }
    }
  </style>
</head>
<body>
  <!-- 상단: 검색 + 오디오 -->
  <table class="top-fixed-table" id="main-table" cellpadding="0" cellspacing="0">
    <tr>
      <td class="search-cell">
        <form name="f1" action="">
          <input type="reset" name="b2" value="X">
          <input type="text" placeholder="검색어 입력" name="t1" value="">
          <input type="submit" name="b1" value="검색">
          <div id="search-count-container">
            <span id="search-count"></span>
            <button type="button" id="next-location-btn" style="display:none;">다음 위치</button>
          </div>
        </form>
      </td>

      <td class="audio-cell">
        <div id="custom-audio-player" role="region" aria-label="오디오 플레이어">
          <audio id="audio-file" preload="auto" playsinline>
            <source src="https://vod47.anyline.co.kr/vod_ezra/%EC%9D%BD%EA%B8%B0%2090.mp3" type="audio/mpeg">
            브라우저가 오디오 요소를 지원하지 않습니다.
          </audio>

          <div class="player-controls">
            <strong><span style="font-size:16px; background-color:#fcfcfc;" id="current-time" class="time-display">0:00</span></strong>
            <button id="play-btn" class="control-btn" aria-label="재생">▶</button>
            <button id="pause-btn" class="control-btn" aria-label="일시정지">⏸</button>
            <button id="stop-btn" class="control-btn" aria-label="정지">■</button>
            <strong><span style="font-size:16px; background-color:#fcfcfc;" id="remaining-time" class="time-display">0:00</span></strong>
          </div>

          <div class="toggle-buttons">
            <button id="show-progress">재생 위치</button>
            <button id="show-speed">재생 속도</button>
            <button id="show-volume">볼륨 조절</button>
          </div>

          <div class="progress-container" style="display:none;">
            <button id="rewind-10" class="skip-btn">⏪10s</button>
            <input type="range" id="progress-bar" min="0" max="100" value="0" step="0.01" aria-label="재생 위치">
            <button id="forward-10" class="skip-btn">10s⏩</button>
          </div>

          <div class="speed-controls" style="display:none;">
            <button id="speed-down-02" class="speed-btn">&laquo;</button>
            <button id="speed-down-01" class="speed-btn">&lt;</button>
            <span id="speed-display" class="speed-display">1.0x</span>
            <button id="speed-up-01" class="speed-btn">&gt;</button>
            <button id="speed-up-02" class="speed-btn">&raquo;</button>
            <button id="speed-reset">1.0</button>
          </div>

          <div class="volume-control" style="display:none;">
            <span style="font-size:14px;">볼륨</span>
            <button id="mute-btn">🔊</button>
            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
          </div>
        </div>
      </td>
    </tr>
  </table>

  <!-- 플로팅 책 버튼 (구절설명 토글) -->
  <div class="explanation-button-container" id="explanation-button-container">
    <div class="explanation-button-wrapper" id="explanation-button-wrapper">
      <button class="explanation-icon-button" id="explanation-icon-button" aria-label="구절설명 열기" title="단어나 문장을 선택하면 ‘간단설명’ 또는 ‘상세설명’을 볼 수 있어요.">
        <span>📖</span>
      </button>
      <div class="explanation-sub-buttons" id="explanation-sub-buttons" role="menu">
        <button class="explanation-sub-button" id="detailed-explanation-button">상세 구절설명</button>
        <button class="explanation-sub-button" id="simple-explanation-button">간단 구절설명</button>
      </div>
    </div>
  </div>

  <!-- 폰트 크기 + 본문 요약 버튼 -->
  <div class="container" style="margin-top:6px;">
    <p class="font-size-label">Font Size</p>
    <button id="down">-</button>
    <p id="font-size">20</p>
    <button id="up">+</button>

    <span class="summary-buttons" aria-hidden="false">
      <button class="summary-btn" id="summary-simple-main">본문요약 간단</button>
      <button class="summary-btn" id="summary-detailed-main">본문요약 상세</button>
    </span>
  </div>

  <!-- 본문 -->
  <div>
    <h2 id="bible-text" style="line-height:1.2em;margin-left:15px;margin-right:15px;font-style:normal;font-weight:normal;color:black;font-size:20px;word-break:break-all;">
    <strong>
<!-- 일차 내비게이션 -->
<nav class="day-nav" aria-label="일차 이동">
  <a class="day-btn" href="https://seagwang1124.github.io/90html/89%EC%9D%BC%EC%B0%A8.html" aria-label="통독 89일차로 이동">≪</a>
  <span class="day-title"> 통독 90일차 </span>
 
  <a class="day-btn" href="https://seagwang1124.github.io/90html" aria-label="통독 목록으로 이동">통독 목록</a>
</nav>
      
<br>범위: 요한계시록 12장- 22장</br></strong>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 12 장</font></br></strong>
<br><i><font color="#808080">*여자와 용*</font></i></br>
<br>1 하늘에 큰 이적이 보이니 해를 옷 입은 한 여자가 있는데 그 발 아래에는 달이 있고 그 머리에는 열두 별의 관을 썼더라</br>
<br>2 이 여자가 아이를 배어 해산하게 되매 아파서 애를 쓰며 부르짖더라</br>
<br>3 하늘에 또 다른 이적이 보이니 보라 한 큰 붉은 용이 있어 머리가 일곱이요 뿔이 열이라 그 여러 머리에 일곱 왕관이 있는데</br>
<br>4 그 꼬리가 하늘의 별 삼분의 일을 끌어다가 땅에 던지더라 용이 해산하려는 여자 앞에서 그가 해산하면 그 아이를 삼키고자 하더니</br>
<br>5 여자가 아들을 낳으니 이는 장차 철장으로 만국을 다스릴 남자라 그 아이를 하나님 앞과 그 보좌 앞으로 올려가더라</br>
<br>6 그 여자가 광야로 도망하매 거기서 천이백육십 일 동안 그를 양육하기 위하여 하나님께서 예비하신 곳이 있더라</br>
<br>7 하늘에 전쟁이 있으니 미가엘과 그의 사자들이 용과 더불어 싸울새 용과 그의 사자들도 싸우나</br>
<br>8 이기지 못하여 다시 하늘에서 그들이 있을 곳을 얻지 못한지라</br>
<br>9 큰 용이 내쫓기니 옛 뱀 곧 마귀라고도 하고 사탄이라고도 하며 온 천하를 꾀는 자라 그가 땅으로 내쫓기니 그의 사자들도 그와 함께 내쫓기니라</br>
<br>10 내가 또 들으니 하늘에 큰 음성이 있어 이르되 이제 우리 하나님의 구원과 능력과 나라와 또 그의 그리스도의 권세가 나타났으니 우리 형제들을 참소하던 자 곧 우리 하나님 앞에서 밤낮 참소하던 자가 쫓겨났고</br>
<br>11 또 우리 형제들이 어린 양의 피와 자기들이 증언하는 말씀으로써 그를 이겼으니 그들은 죽기까지 자기들의 생명을 아끼지 아니하였도다</br>
<br>12 그러므로 하늘과 그 가운데에 거하는 자들은 즐거워하라 그러나 땅과 바다는 화 있을진저 이는 마귀가 자기의 때가 얼마 남지 않은 줄을 알므로 크게 분내어 너희에게 내려갔음이라 하더라</br>
<br>13 용이 자기가 땅으로 내쫓긴 것을 보고 남자를 낳은 여자를 박해하는지라</br>
<br>14 그 여자가 큰 독수리의 두 날개를 받아 광야 자기 곳으로 날아가 거기서 그 뱀의 낯을 피하여 한 때와 두 때와 반 때를 양육 받으매</br>
<br>15 여자의 뒤에서 뱀이 그 입으로 물을 강 같이 토하여 여자를 물에 떠내려 가게 하려 하되</br>
<br>16 땅이 여자를 도와 그 입을 벌려 용의 입에서 토한 강물을 삼키니</br>
<br>17 용이 여자에게 분노하여 돌아가서 그 여자의 남은 자손 곧 하나님의 계명을 지키며 예수의 증거를 가진 자들과 더불어 싸우려고 바다 모래 위에 서 있더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 13 장</font></br></strong>
<br><i><font color="#808080">*짐승 두 마리*</font></i></br>
<br>1 내가 보니 바다에서 한 짐승이 나오는데 뿔이 열이요 머리가 일곱이라 그 뿔에는 열 왕관이 있고 그 머리들에는 신성모독 하는 이름들이 있더라</br>
<br>2 내가 본 짐승은 표범과 비슷하고 그 발은 곰의 발 같고 그 입은 사자의 입 같은데 용이 자기의 능력과 보좌와 큰 권세를 그에게 주었더라</br>
<br>3 그의 머리 하나가 상하여 죽게 된 것 같더니 그 죽게 되었던 상처가 나으매 온 땅이 놀랍게 여겨 짐승을 따르고</br>
<br>4 용이 짐승에게 권세를 주므로 용에게 경배하며 짐승에게 경배하여 이르되 누가 이 짐승과 같으냐 누가 능히 이와 더불어 싸우리요 하더라</br>
<br>5 또 짐승이 과장되고 신성모독을 말하는 입을 받고 또 마흔두 달 동안 일할 권세를 받으니라</br>
<br>6 짐승이 입을 벌려 하나님을 향하여 비방하되 그의 이름과 그의 장막 곧 하늘에 사는 자들을 비방하더라</br>
<br>7 또 권세를 받아 성도들과 싸워 이기게 되고 각 족속과 백성과 방언과 나라를 다스리는 권세를 받으니</br>
<br>8 죽임을 당한 어린 양의 생명책에 창세 이후로 이름이 기록되지 못하고 이 땅에 사는 자들은 다 그 짐승에게 경배하리라</br>
<br>9 누구든지 귀가 있거든 들을지어다</br>
<br>10 사로잡힐 자는 사로잡혀 갈 것이요 칼에 죽을 자는 마땅히 칼에 죽을 것이니 성도들의 인내와 믿음이 여기 있느니라</br>
<br>11 내가 보매 또 다른 짐승이 땅에서 올라오니 어린 양 같이 두 뿔이 있고 용처럼 말을 하더라</br>
<br>12 그가 먼저 나온 짐승의 모든 권세를 그 앞에서 행하고 땅과 땅에 사는 자들을 처음 짐승에게 경배하게 하니 곧 죽게 되었던 상처가 나은 자니라</br>
<br>13 큰 이적을 행하되 심지어 사람들 앞에서 불이 하늘로부터 땅에 내려오게 하고</br>
<br>14 짐승 앞에서 받은 바 이적을 행함으로 땅에 거하는 자들을 미혹하며 땅에 거하는 자들에게 이르기를 칼에 상하였다가 살아난 짐승을 위하여 우상을 만들라 하더라</br>
<br>15 그가 권세를 받아 그 짐승의 우상에게 생기를 주어 그 짐승의 우상으로 말하게 하고 또 짐승의 우상에게 경배하지 아니하는 자는 몇이든지 다 죽이게 하더라</br>
<br>16 그가 모든 자 곧 작은 자나 큰 자나 부자나 가난한 자나 자유인이나 종들에게 그 오른손에나 이마에 표를 받게 하고</br>
<br>17 누구든지 이 표를 가진 자 외에는 매매를 못하게 하니 이 표는 곧 짐승의 이름이나 그 이름의 수라</br>
<br>18 지혜가 여기 있으니 총명한 자는 그 짐승의 수를 세어 보라 그것은 사람의 수니 그의 수는 육백육십육이니라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 14 장</font></br></strong>
<br><i><font color="#808080">*십사만 사천 명이 부르는 노래*</font></i></br>
<br>1 또 내가 보니 보라 어린 양이 시온 산에 섰고 그와 함께 십사만 사천이 서 있는데 그들의 이마에는 어린 양의 이름과 그 아버지의 이름을 쓴 것이 있더라</br>
<br>2 내가 하늘에서 나는 소리를 들으니 많은 물 소리와도 같고 큰 우렛소리와도 같은데 내가 들은 소리는 거문고 타는 자들이 그 거문고를 타는 것 같더라</br>
<br>3 그들이 보좌 앞과 네 생물과 장로들 앞에서 새 노래를 부르니 땅에서 속량함을 받은 십사만 사천 밖에는 능히 이 노래를 배울 자가 없더라</br>
<br>4 이 사람들은 여자와 더불어 더럽히지 아니하고 순결한 자라 어린 양이 어디로 인도하든지 따라가는 자며 사람 가운데에서 속량함을 받아 처음 익은 열매로 하나님과 어린 양에게 속한 자들이니</br>
<br>5 그 입에 거짓말이 없고 흠이 없는 자들이더라</br>
<br><i><font color="#808080">*세 천사가 전하는 말*</font></i></br>
<br>6 또 보니 다른 천사가 공중에 날아가는데 땅에 거주하는 자들 곧 모든 민족과 종족과 방언과 백성에게 전할 영원한 복음을 가졌더라</br>
<br>7 그가 큰 음성으로 이르되 하나님을 두려워하며 그에게 영광을 돌리라 이는 그의 심판의 시간이 이르렀음이니 하늘과 땅과 바다와 물들의 근원을 만드신 이를 경배하라 하더라</br>
<br>8 또 다른 천사 곧 둘째가 그 뒤를 따라 말하되 무너졌도다 무너졌도다 큰 성 바벨론이여 모든 나라에게 그의 음행으로 말미암아 진노의 포도주를 먹이던 자로다 하더라</br>
<br>9 또 다른 천사 곧 셋째가 그 뒤를 따라 큰 음성으로 이르되 만일 누구든지 짐승과 그의 우상에게 경배하고 이마에나 손에 표를 받으면</br>
<br>10 그도 하나님의 진노의 포도주를 마시리니 그 진노의 잔에 섞인 것이 없이 부은 포도주라 거룩한 천사들 앞과 어린 양 앞에서 불과 유황으로 고난을 받으리니</br>
<br>11 그 고난의 연기가 세세토록 올라가리로다 짐승과 그의 우상에게 경배하고 그의 이름 표를 받는 자는 누구든지 밤낮 쉼을 얻지 못하리라 하더라</br>
<br>12 성도들의 인내가 여기 있나니 그들은 하나님의 계명과 예수에 대한 믿음을 지키는 자니라</br>
<br>13 또 내가 들으니 하늘에서 음성이 나서 이르되 기록하라 지금 이후로 주 안에서 죽는 자들은 복이 있도다 하시매 성령이 이르시되 그러하다 그들이 수고를 그치고 쉬리니 이는 그들의 행한 일이 따름이라 하시더라</br>
<br><i><font color="#808080">*마지막 수확*</font></i></br>
<br>14 또 내가 보니 흰 구름이 있고 구름 위에 인자와 같은 이가 앉으셨는데 그 머리에는 금 면류관이 있고 그 손에는 예리한 낫을 가졌더라</br>
<br>15 또 다른 천사가 성전으로부터 나와 구름 위에 앉은 이를 향하여 큰 음성으로 외쳐 이르되 당신의 낫을 휘둘러 거두소서 땅의 곡식이 다 익어 거둘 때가 이르렀음이니이다 하니</br>
<br>16 구름 위에 앉으신 이가 낫을 땅에 휘두르매 땅의 곡식이 거두어지니라</br>
<br><i><font color="#808080">*마지막 재난을 가지고 온 천사*</font></i></br>
<br>17 또 다른 천사가 하늘에 있는 성전에서 나오는데 역시 예리한 낫을 가졌더라</br>
<br>18 또 불을 다스리는 다른 천사가 제단으로부터 나와 예리한 낫 가진 자를 향하여 큰 음성으로 불러 이르되 네 예리한 낫을 휘둘러 땅의 포도송이를 거두라 그 포도가 익었느니라 하더라</br>
<br>19 천사가 낫을 땅에 휘둘러 땅의 포도를 거두어 하나님의 진노의 큰 포도주 틀에 던지매</br>
<br>20 성 밖에서 그 틀이 밟히니 틀에서 피가 나서 말 굴레에까지 닿았고 천육백 스다디온에 퍼졌더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 15 장</font></br></strong>
<br>1 또 하늘에 크고 이상한 다른 이적을 보매 일곱 천사가 일곱 재앙을 가졌으니 곧 마지막 재앙이라 하나님의 진노가 이것으로 마치리로다</br>
<br>2 또 내가 보니 불이 섞인 유리 바다 같은 것이 있고 짐승과 그의 우상과 그의 이름의 수를 이기고 벗어난 자들이 유리 바다 가에 서서 하나님의 거문고를 가지고</br>
<br>3 하나님의 종 모세의 노래, 어린 양의 노래를 불러 이르되 주 하나님 곧 전능하신 이시여 하시는 일이 크고 놀라우시도다 만국의 왕이시여 주의 길이 의롭고 참되시도다</br>
<br>4 주여 누가 주의 이름을 두려워하지 아니하며 영화롭게 하지 아니하오리이까 오직 주만 거룩하시니이다 주의 의로우신 일이 나타났으매 만국이 와서 주께 경배하리이다 하더라</br>
<br>5 또 이 일 후에 내가 보니 하늘에 증거 장막의 성전이 열리며</br>
<br>6 일곱 재앙을 가진 일곱 천사가 성전으로부터 나와 맑고 빛난 세마포 옷을 입고 가슴에 금 띠를 띠고</br>
<br>7 네 생물 중의 하나가 영원토록 살아 계신 하나님의 진노를 가득히 담은 금 대접 일곱을 그 일곱 천사들에게 주니</br>
<br>8 하나님의 영광과 능력으로 말미암아 성전에 연기가 가득 차매 일곱 천사의 일곱 재앙이 마치기까지는 성전에 능히 들어갈 자가 없더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 16 장</font></br></strong>
<br><i><font color="#808080">*진노의 일곱 대접*</font></i></br>
<br>1 또 내가 들으니 성전에서 큰 음성이 나서 일곱 천사에게 말하되 너희는 가서 하나님의 진노의 일곱 대접을 땅에 쏟으라 하더라</br>
<br>2 첫째 천사가 가서 그 대접을 땅에 쏟으매 짐승의 표를 받은 사람들과 그 우상에게 경배하는 자들에게 악하고 독한 종기가 나더라</br>
<br>3 둘째 천사가 그 대접을 바다에 쏟으매 바다가 곧 죽은 자의 피 같이 되니 바다 가운데 모든 생물이 죽더라</br>
<br>4 셋째 천사가 그 대접을 강과 물 근원에 쏟으매 피가 되더라</br>
<br>5 내가 들으니 물을 차지한 천사가 이르되 전에도 계셨고 지금도 계신 거룩하신 이여 이렇게 심판하시니 의로우시도다</br>
<br>6 그들이 성도들과 선지자들의 피를 흘렸으므로 그들에게 피를 마시게 하신 것이 합당하니이다 하더라</br>
<br>7 또 내가 들으니 제단이 말하기를 그러하다 주 하나님 곧 전능하신 이시여 심판하시는 것이 참되시고 의로우시도다 하더라</br>
<br>8 넷째 천사가 그 대접을 해에 쏟으매 해가 권세를 받아 불로 사람들을 태우니</br>
<br>9 사람들이 크게 태움에 태워진지라 이 재앙들을 행하는 권세를 가지신 하나님의 이름을 비방하며 또 회개하지 아니하고 주께 영광을 돌리지 아니하더라</br>
<br>10 또 다섯째 천사가 그 대접을 짐승의 왕좌에 쏟으니 그 나라가 곧 어두워지며 사람들이 아파서 자기 혀를 깨물고</br>
<br>11 아픈 것과 종기로 말미암아 하늘의 하나님을 비방하고 그들의 행위를 회개하지 아니하더라</br>
<br>12 또 여섯째 천사가 그 대접을 큰 강 유브라데에 쏟으매 강물이 말라서 동방에서 오는 왕들의 길이 예비되었더라</br>
<br>13 또 내가 보매 개구리 같은 세 더러운 영이 용의 입과 짐승의 입과 거짓 선지자의 입에서 나오니</br>
<br>14 그들은 귀신의 영이라 이적을 행하여 온 천하 왕들에게 가서 하나님 곧 전능하신 이의 큰 날에 있을 전쟁을 위하여 그들을 모으더라</br>
<br>15 보라 내가 도둑 같이 오리니 누구든지 깨어 자기 옷을 지켜 벌거벗고 다니지 아니하며 자기의 부끄러움을 보이지 아니하는 자는 복이 있도다</br>
<br>16 세 영이 히브리어로 아마겟돈이라 하는 곳으로 왕들을 모으더라</br>
<br>17 일곱째 천사가 그 대접을 공중에 쏟으매 큰 음성이 성전에서 보좌로부터 나서 이르되 되었다 하시니</br>
<br>18 번개와 음성들과 우렛소리가 있고 또 큰 지진이 있어 얼마나 큰지 사람이 땅에 있어 온 이래로 이같이 큰 지진이 없었더라</br>
<br>19 큰 성이 세 갈래로 갈라지고 만국의 성들도 무너지니 큰 성 바벨론이 하나님 앞에 기억하신 바 되어 그의 맹렬한 진노의 포도주 잔을 받으매</br>
<br>20 각 섬도 없어지고 산악도 간 데 없더라</br>
<br>21 또 무게가 한 달란트나 되는 큰 우박이 하늘로부터 사람들에게 내리매 사람들이 그 우박의 재앙 때문에 하나님을 비방하니 그 재앙이 심히 큼이러라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 17 장</font></br></strong>
<br><i><font color="#808080">*큰 음녀에게 내릴 심판*</font></i></br>
<br>1 또 일곱 대접을 가진 일곱 천사 중 하나가 와서 내게 말하여 이르되 이리로 오라 많은 물 위에 앉은 큰 음녀가 받을 심판을 네게 보이리라</br>
<br>2 땅의 임금들도 그와 더불어 음행하였고 땅에 사는 자들도 그 음행의 포도주에 취하였다 하고</br>
<br>3 곧 성령으로 나를 데리고 광야로 가니라 내가 보니 여자가 붉은 빛 짐승을 탔는데 그 짐승의 몸에 하나님을 모독하는 이름들이 가득하고 일곱 머리와 열 뿔이 있으며</br>
<br>4 그 여자는 자주 빛과 붉은 빛 옷을 입고 금과 보석과 진주로 꾸미고 손에 금 잔을 가졌는데 가증한 물건과 그의 음행의 더러운 것들이 가득하더라</br>
<br>5 그의 이마에 이름이 기록되었으니 비밀이라, 큰 바벨론이라, 땅의 음녀들과 가증한 것들의 어미라 하였더라</br>
<br>6 또 내가 보매 이 여자가 성도들의 피와 예수의 증인들의 피에 취한지라 내가 그 여자를 보고 놀랍게 여기고 크게 놀랍게 여기니</br>
<br>7 천사가 이르되 왜 놀랍게 여기느냐 내가 여자와 그가 탄 일곱 머리와 열 뿔 가진 짐승의 비밀을 네게 이르리라</br>
<br>8 네가 본 짐승은 전에 있었다가 지금은 없으나 장차 무저갱으로부터 올라와 멸망으로 들어갈 자니 땅에 사는 자들로서 창세 이후로 그 이름이 생명책에 기록되지 못한 자들이 이전에 있었다가 지금은 없으나 장차 나올 짐승을 보고 놀랍게 여기리라</br>
<br>9 지혜 있는 뜻이 여기 있으니 그 일곱 머리는 여자가 앉은 일곱 산이요</br>
<br>10 또 일곱 왕이라 다섯은 망하였고 하나는 있고 다른 하나는 아직 이르지 아니하였으나 이르면 반드시 잠시 동안 머무르리라</br>
<br>11 전에 있었다가 지금 없어진 짐승은 여덟째 왕이니 일곱 중에 속한 자라 그가 멸망으로 들어가리라</br>
<br>12 네가 보던 열 뿔은 열 왕이니 아직 나라를 얻지 못하였으나 다만 짐승과 더불어 임금처럼 한동안 권세를 받으리라</br>
<br>13 그들이 한 뜻을 가지고 자기의 능력과 권세를 짐승에게 주더라</br>
<br>14 그들이 어린 양과 더불어 싸우려니와 어린 양은 만주의 주시요 만왕의 왕이시므로 그들을 이기실 터이요 또 그와 함께 있는 자들 곧 부르심을 받고 택하심을 받은 진실한 자들도 이기리로다</br>
<br>15 또 천사가 내게 말하되 네가 본 바 음녀가 앉아 있는 물은 백성과 무리와 열국과 방언들이니라</br>
<br>16 네가 본 바 이 열 뿔과 짐승은 음녀를 미워하여 망하게 하고 벌거벗게 하고 그의 살을 먹고 불로 아주 사르리라</br>
<br>17 이는 하나님이 자기 뜻대로 할 마음을 그들에게 주사 한 뜻을 이루게 하시고 그들의 나라를 그 짐승에게 주게 하시되 하나님의 말씀이 응하기까지 하심이라</br>
<br>18 또 네가 본 그 여자는 땅의 왕들을 다스리는 큰 성이라 하더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 18 장</font></br></strong>
<br><i><font color="#808080">*바벨론의 패망*</font></i></br>
<br>1 이 일 후에 다른 천사가 하늘에서 내려 오는 것을 보니 큰 권세를 가졌는데 그의 영광으로 땅이 환하여지더라</br>
<br>2 힘찬 음성으로 외쳐 이르되 무너졌도다 무너졌도다 큰 성 바벨론이여 귀신의 처소와 각종 더러운 영이 모이는 곳과 각종 더럽고 가증한 새들이 모이는 곳이 되었도다</br>
<br>3 그 음행의 진노의 포도주로 말미암아 만국이 무너졌으며 또 땅의 왕들이 그와 더불어 음행하였으며 땅의 상인들도 그 사치의 세력으로 치부하였도다 하더라</br>
<br>4 또 내가 들으니 하늘로부터 다른 음성이 나서 이르되 내 백성아, 거기서 나와 그의 죄에 참여하지 말고 그가 받을 재앙들을 받지 말라</br>
<br>5 그의 죄는 하늘에 사무쳤으며 하나님은 그의 불의한 일을 기억하신지라</br>
<br>6 그가 준 그대로 그에게 주고 그의 행위대로 갑절을 갚아 주고 그가 섞은 잔에도 갑절이나 섞어 그에게 주라</br>
<br>7 그가 얼마나 자기를 영화롭게 하였으며 사치하였든지 그만큼 고통과 애통함으로 갚아 주라 그가 마음에 말하기를 나는 여왕으로 앉은 자요 과부가 아니라 결단코 애통함을 당하지 아니하리라 하니</br>
<br>8 그러므로 하루 동안에 그 재앙들이 이르리니 곧 사망과 애통함과 흉년이라 그가 또한 불에 살라지리니 그를 심판하시는 주 하나님은 강하신 자이심이라</br>
<br>9 그와 함께 음행하고 사치하던 땅의 왕들이 그가 불타는 연기를 보고 위하여 울고 가슴을 치며</br>
<br>10 그의 고통을 무서워하여 멀리 서서 이르되 화 있도다 화 있도다 큰 성, 견고한 성 바벨론이여 한 시간에 네 심판이 이르렀다 하리로다</br>
<br>11 땅의 상인들이 그를 위하여 울고 애통하는 것은 다시 그들의 상품을 사는 자가 없음이라</br>
<br>12 그 상품은 금과 은과 보석과 진주와 세마포와 자주 옷감과 비단과 붉은 옷감이요 각종 향목과 각종 상아 그릇이요 값진 나무와 구리와 철과 대리석으로 만든 각종 그릇이요</br>
<br>13 계피와 향료와 향과 향유와 유향과 포도주와 감람유와 고운 밀가루와 밀이요 소와 양과 말과 수레와 종들과 사람의 영혼들이라</br>
<br>14 바벨론아 네 영혼이 탐하던 과일이 네게서 떠났으며 맛있는 것들과 빛난 것들이 다 없어졌으니 사람들이 결코 이것들을 다시 보지 못하리로다</br>
<br>15 바벨론으로 말미암아 치부한 이 상품의 상인들이 그의 고통을 무서워하여 멀리 서서 울고 애통하여</br>
<br>16 이르되 화 있도다 화 있도다 큰 성이여 세마포 옷과 자주 옷과 붉은 옷을 입고 금과 보석과 진주로 꾸민 것인데</br>
<br>17 그러한 부가 한 시간에 망하였도다 모든 선장과 각처를 다니는 선객들과 선원들과 바다에서 일하는 자들이 멀리 서서</br>
<br>18 그가 불타는 연기를 보고 외쳐 이르되 이 큰 성과 같은 성이 어디 있느냐 하며</br>
<br>19 티끌을 자기 머리에 뿌리고 울며 애통하여 외쳐 이르되 화 있도다 화 있도다 이 큰 성이여 바다에서 배 부리는 모든 자들이 너의 보배로운 상품으로 치부하였더니 한 시간에 망하였도다</br>
<br>20 하늘과 성도들과 사도들과 선지자들아, 그로 말미암아 즐거워하라 하나님이 너희를 위하여 그에게 심판을 행하셨음이라 하더라</br>
<br>21 이에 한 힘 센 천사가 큰 맷돌 같은 돌을 들어 바다에 던져 이르되 큰 성 바벨론이 이같이 비참하게 던져져 결코 다시 보이지 아니하리로다</br>
<br>22 또 거문고 타는 자와 풍류하는 자와 퉁소 부는 자와 나팔 부는 자들의 소리가 결코 다시 네 안에서 들리지 아니하고 어떠한 세공업자든지 결코 다시 네 안에서 보이지 아니하고 또 맷돌 소리가 결코 다시 네 안에서 들리지 아니하고</br>
<br>23 등불 빛이 결코 다시 네 안에서 비치지 아니하고 신랑과 신부의 음성이 결코 다시 네 안에서 들리지 아니하리로다 너의 상인들은 땅의 왕족들이라 네 복술로 말미암아 만국이 미혹되었도다</br>
<br>24 선지자들과 성도들과 및 땅 위에서 죽임을 당한 모든 자의 피가 그 성 중에서 발견되었느니라 하더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 19 장</font></br></strong>
<br><i><font color="#808080">*어린 양의 혼인 잔치*</font></i></br>
<br>1 이 일 후에 내가 들으니 하늘에 허다한 무리의 큰 음성 같은 것이 있어 이르되 할렐루야 구원과 영광과 능력이 우리 하나님께 있도다</br>
<br>2 그의 심판은 참되고 의로운지라 음행으로 땅을 더럽게 한 큰 음녀를 심판하사 자기 종들의 피를 그 음녀의 손에 갚으셨도다 하고</br>
<br>3 두 번째로 할렐루야 하니 그 연기가 세세토록 올라가더라</br>
<br>4 또 이십사 장로와 네 생물이 엎드려 보좌에 앉으신 하나님께 경배하여 이르되 아멘 할렐루야 하니</br>
<br>5 보좌에서 음성이 나서 이르시되 하나님의 종들 곧 그를 경외하는 너희들아 작은 자나 큰 자나 다 우리 하나님께 찬송하라 하더라</br>
<br>6 또 내가 들으니 허다한 무리의 음성과도 같고 많은 물 소리와도 같고 큰 우렛소리와도 같은 소리로 이르되 할렐루야 주 우리 하나님 곧 전능하신 이가 통치하시도다</br>
<br>7 우리가 즐거워하고 크게 기뻐하며 그에게 영광을 돌리세 어린 양의 혼인 기약이 이르렀고 그의 아내가 자신을 준비하였으므로</br>
<br>8 그에게 빛나고 깨끗한 세마포 옷을 입도록 허락하셨으니 이 세마포 옷은 성도들의 옳은 행실이로다 하더라</br>
<br>9 천사가 내게 말하기를 기록하라 어린 양의 혼인 잔치에 청함을 받은 자들은 복이 있도다 하고 또 내게 말하되 이것은 하나님의 참되신 말씀이라 하기로</br>
<br>10 내가 그 발 앞에 엎드려 경배하려 하니 그가 나에게 말하기를 나는 너와 및 예수의 증언을 받은 네 형제들과 같이 된 종이니 삼가 그리하지 말고 오직 하나님께 경배하라 예수의 증언은 예언의 영이라 하더라</br>
<br><i><font color="#808080">*백마를 탄 자*</font></i></br>
<br>11 또 내가 하늘이 열린 것을 보니 보라 백마와 그것을 탄 자가 있으니 그 이름은 충신과 진실이라 그가 공의로 심판하며 싸우더라</br>
<br>12 그 눈은 불꽃 같고 그 머리에는 많은 관들이 있고 또 이름 쓴 것 하나가 있으니 자기밖에 아는 자가 없고</br>
<br>13 또 그가 피 뿌린 옷을 입었는데 그 이름은 하나님의 말씀이라 칭하더라</br>
<br>14 하늘에 있는 군대들이 희고 깨끗한 세마포 옷을 입고 백마를 타고 그를 따르더라</br>
<br>15 그의 입에서 예리한 검이 나오니 그것으로 만국을 치겠고 친히 그들을 철장으로 다스리며 또 친히 하나님 곧 전능하신 이의 맹렬한 진노의 포도주 틀을 밟겠고</br>
<br>16 그 옷과 그 다리에 이름을 쓴 것이 있으니 만왕의 왕이요 만주의 주라 하였더라</br>
<br>17 또 내가 보니 한 천사가 태양 안에 서서 공중에 나는 모든 새를 향하여 큰 음성으로 외쳐 이르되 와서 하나님의 큰 잔치에 모여</br>
<br>18 왕들의 살과 장군들의 살과 장사들의 살과 말들과 그것을 탄 자들의 살과 자유인들이나 종들이나 작은 자나 큰 자나 모든 자의 살을 먹으라 하더라</br>
<br>19 또 내가 보매 그 짐승과 땅의 임금들과 그들의 군대들이 모여 그 말 탄 자와 그의 군대와 더불어 전쟁을 일으키다가</br>
<br>20 짐승이 잡히고 그 앞에서 표적을 행하던 거짓 선지자도 함께 잡혔으니 이는 짐승의 표를 받고 그의 우상에게 경배하던 자들을 표적으로 미혹하던 자라 이 둘이 산 채로 유황불 붙는 못에 던져지고</br>
<br>21 그 나머지는 말 탄 자의 입으로부터 나오는 검에 죽으매 모든 새가 그들의 살로 배불리더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 20 장</font></br></strong>
<br><i><font color="#808080">*천 년 왕국*</font></i></br>
<br>1 또 내가 보매 천사가 무저갱의 열쇠와 큰 쇠사슬을 그의 손에 가지고 하늘로부터 내려와서</br>
<br>2 용을 잡으니 곧 옛 뱀이요 마귀요 사탄이라 잡아서 천 년 동안 결박하여</br>
<br>3 무저갱에 던져 넣어 잠그고 그 위에 인봉하여 천 년이 차도록 다시는 만국을 미혹하지 못하게 하였는데 그 후에는 반드시 잠깐 놓이리라</br>
<br>4 또 내가 보좌들을 보니 거기에 앉은 자들이 있어 심판하는 권세를 받았더라 또 내가 보니 예수를 증언함과 하나님의 말씀 때문에 목 베임을 당한 자들의 영혼들과 또 짐승과 그의 우상에게 경배하지 아니하고 그들의 이마와 손에 그의 표를 받지 아니한 자들이 살아서 그리스도와 더불어 천 년 동안 왕 노릇 하니</br>
<br>5 (그 나머지 죽은 자들은 그 천 년이 차기까지 살지 못하더라) 이는 첫째 부활이라</br>
<br>6 이 첫째 부활에 참여하는 자들은 복이 있고 거룩하도다 둘째 사망이 그들을 다스리는 권세가 없고 도리어 그들이 하나님과 그리스도의 제사장이 되어 천 년 동안 그리스도와 더불어 왕 노릇 하리라</br>
<br><i><font color="#808080">*사탄의 패망*</font></i></br>
<br>7 천 년이 차매 사탄이 그 옥에서 놓여</br>
<br>8 나와서 땅의 사방 백성 곧 곡과 마곡을 미혹하고 모아 싸움을 붙이리니 그 수가 바다의 모래 같으리라</br>
<br>9 그들이 지면에 널리 퍼져 성도들의 진과 사랑하시는 성을 두르매 하늘에서 불이 내려와 그들을 태워버리고</br>
<br>10 또 그들을 미혹하는 마귀가 불과 유황 못에 던져지니 거기는 그 짐승과 거짓 선지자도 있어 세세토록 밤낮 괴로움을 받으리라</br>
<br><i><font color="#808080">*크고 흰 보좌에서 심판을 내리시다*</font></i></br>
<br>11 또 내가 크고 흰 보좌와 그 위에 앉으신 이를 보니 땅과 하늘이 그 앞에서 피하여 간 데 없더라</br>
<br>12 또 내가 보니 죽은 자들이 큰 자나 작은 자나 그 보좌 앞에 서 있는데 책들이 펴 있고 또 다른 책이 펴졌으니 곧 생명책이라 죽은 자들이 자기 행위를 따라 책들에 기록된 대로 심판을 받으니</br>
<br>13 바다가 그 가운데에서 죽은 자들을 내주고 또 사망과 음부도 그 가운데에서 죽은 자들을 내주매 각 사람이 자기의 행위대로 심판을 받고</br>
<br>14 사망과 음부도 불못에 던져지니 이것은 둘째 사망 곧 불못이라</br>
<br>15 누구든지 생명책에 기록되지 못한 자는 불못에 던져지더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 21 장</font></br></strong>
<br><i><font color="#808080">*새 하늘과 새 땅*</font></i></br>
<br>1 또 내가 새 하늘과 새 땅을 보니 처음 하늘과 처음 땅이 없어졌고 바다도 다시 있지 않더라</br>
<br>2 또 내가 보매 거룩한 성 새 예루살렘이 하나님께로부터 하늘에서 내려오니 그 준비한 것이 신부가 남편을 위하여 단장한 것 같더라</br>
<br>3 내가 들으니 보좌에서 큰 음성이 나서 이르되 보라 하나님의 장막이 사람들과 함께 있으매 하나님이 그들과 함께 계시리니 그들은 하나님의 백성이 되고 하나님은 친히 그들과 함께 계셔서</br>
<br>4 모든 눈물을 그 눈에서 닦아 주시니 다시는 사망이 없고 애통하는 것이나 곡하는 것이나 아픈 것이 다시 있지 아니하리니 처음 것들이 다 지나갔음이러라</br>
<br>5 보좌에 앉으신 이가 이르시되 보라 내가 만물을 새롭게 하노라 하시고 또 이르시되 이 말은 신실하고 참되니 기록하라 하시고</br>
<br>6 또 내게 말씀하시되 이루었도다 나는 알파와 오메가요 처음과 마지막이라 내가 생명수 샘물을 목마른 자에게 값없이 주리니</br>
<br>7 이기는 자는 이것들을 상속으로 받으리라 나는 그의 하나님이 되고 그는 내 아들이 되리라</br>
<br>8 그러나 두려워하는 자들과 믿지 아니하는 자들과 흉악한 자들과 살인자들과 음행하는 자들과 점술가들과 우상 숭배자들과 거짓말하는 모든 자들은 불과 유황으로 타는 못에 던져지리니 이것이 둘째 사망이라</br>
<br><i><font color="#808080">*새 예루살렘*</font></i></br>
<br>9 일곱 대접을 가지고 마지막 일곱 재앙을 담은 일곱 천사 중 하나가 나아와서 내게 말하여 이르되 이리 오라 내가 신부 곧 어린 양의 아내를 네게 보이리라 하고</br>
<br>10 성령으로 나를 데리고 크고 높은 산으로 올라가 하나님께로부터 하늘에서 내려오는 거룩한 성 예루살렘을 보이니</br>
<br>11 하나님의 영광이 있어 그 성의 빛이 지극히 귀한 보석 같고 벽옥과 수정 같이 맑더라</br>
<br>12 크고 높은 성곽이 있고 열두 문이 있는데 문에 열두 천사가 있고 그 문들 위에 이름을 썼으니 이스라엘 자손 열두 지파의 이름들이라</br>
<br>13 동쪽에 세 문, 북쪽에 세 문, 남쪽에 세 문, 서쪽에 세 문이니</br>
<br>14 그 성의 성곽에는 열두 기초석이 있고 그 위에는 어린 양의 열두 사도의 열두 이름이 있더라</br>
<br>15 내게 말하는 자가 그 성과 그 문들과 성곽을 측량하려고 금 갈대 자를 가졌더라</br>
<br>16 그 성은 네모가 반듯하여 길이와 너비가 같은지라 그 갈대 자로 그 성을 측량하니 만 이천 스다디온이요 길이와 너비와 높이가 같더라</br>
<br>17 그 성곽을 측량하매 백사십사 규빗이니 사람의 측량 곧 천사의 측량이라</br>
<br>18 그 성곽은 벽옥으로 쌓였고 그 성은 정금인데 맑은 유리 같더라</br>
<br>19 그 성의 성곽의 기초석은 각색 보석으로 꾸몄는데 첫째 기초석은 벽옥이요 둘째는 남보석이요 셋째는 옥수요 넷째는 녹보석이요</br>
<br>20 다섯째는 홍마노요 여섯째는 홍보석이요 일곱째는 황옥이요 여덟째는 녹옥이요 아홉째는 담황옥이요 열째는 비취옥이요 열한째는 청옥이요 열두째는 자수정이라</br>
<br>21 그 열두 문은 열두 진주니 각 문마다 한 개의 진주로 되어 있고 성의 길은 맑은 유리 같은 정금이더라</br>
<br>22 성 안에서 내가 성전을 보지 못하였으니 이는 주 하나님 곧 전능하신 이와 및 어린 양이 그 성전이심이라</br>
<br>23 그 성은 해나 달의 비침이 쓸 데 없으니 이는 하나님의 영광이 비치고 어린 양이 그 등불이 되심이라</br>
<br>24 만국이 그 빛 가운데로 다니고 땅의 왕들이 자기 영광을 가지고 그리로 들어가리라</br>
<br>25 낮에 성문들을 도무지 닫지 아니하리니 거기에는 밤이 없음이라</br>
<br>26 사람들이 만국의 영광과 존귀를 가지고 그리로 들어가겠고</br>
<br>27 무엇이든지 속된 것이나 가증한 일 또는 거짓말하는 자는 결코 그리로 들어가지 못하되 오직 어린 양의 생명책에 기록된 자들만 들어가리라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">요한계시록 22 장</font></br></strong>
<br>1 또 그가 수정 같이 맑은 생명수의 강을 내게 보이니 하나님과 및 어린 양의 보좌로부터 나와서</br>
<br>2 길 가운데로 흐르더라 강 좌우에 생명나무가 있어 열두 가지 열매를 맺되 달마다 그 열매를 맺고 그 나무 잎사귀들은 만국을 치료하기 위하여 있더라</br>
<br>3 다시 저주가 없으며 하나님과 그 어린 양의 보좌가 그 가운데에 있으리니 그의 종들이 그를 섬기며</br>
<br>4 그의 얼굴을 볼 터이요 그의 이름도 그들의 이마에 있으리라</br>
<br>5 다시 밤이 없겠고 등불과 햇빛이 쓸 데 없으니 이는 주 하나님이 그들에게 비치심이라 그들이 세세토록 왕 노릇 하리로다</br>
<br><i><font color="#808080">*주 예수여 오시옵소서*</font></i></br>
<br>6 또 그가 내게 말하기를 이 말은 신실하고 참된지라 주 곧 선지자들의 영의 하나님이 그의 종들에게 반드시 속히 되어질 일을 보이시려고 그의 천사를 보내셨도다</br>
<br>7 보라 내가 속히 오리니 이 두루마리의 예언의 말씀을 지키는 자는 복이 있으리라 하더라</br>
<br>8 이것들을 보고 들은 자는 나 요한이니 내가 듣고 볼 때에 이 일을 내게 보이던 천사의 발 앞에 경배하려고 엎드렸더니</br>
<br>9 그가 내게 말하기를 나는 너와 네 형제 선지자들과 또 이 두루마리의 말을 지키는 자들과 함께 된 종이니 그리하지 말고 하나님께 경배하라 하더라</br>
<br>10 또 내게 말하되 이 두루마리의 예언의 말씀을 인봉하지 말라 때가 가까우니라</br>
<br>11 불의를 행하는 자는 그대로 불의를 행하고 더러운 자는 그대로 더럽고 의로운 자는 그대로 의를 행하고 거룩한 자는 그대로 거룩하게 하라</br>
<br>12 보라 내가 속히 오리니 내가 줄 상이 내게 있어 각 사람에게 그가 행한 대로 갚아 주리라</br>
<br>13 나는 알파와 오메가요 처음과 마지막이요 시작과 마침이라</br>
<br>14 자기 두루마기를 빠는 자들은 복이 있으니 이는 그들이 생명나무에 나아가며 문들을 통하여 성에 들어갈 권세를 받으려 함이로다</br>
<br>15 개들과 점술가들과 음행하는 자들과 살인자들과 우상 숭배자들과 및 거짓말을 좋아하며 지어내는 자는 다 성 밖에 있으리라</br>
<br>16 나 예수는 교회들을 위하여 내 사자를 보내어 이것들을 너희에게 증언하게 하였노라 나는 다윗의 뿌리요 자손이니 곧 광명한 새벽 별이라 하시더라</br>
<br>17 성령과 신부가 말씀하시기를 오라 하시는도다 듣는 자도 오라 할 것이요 목마른 자도 올 것이요 또 원하는 자는 값없이 생명수를 받으라 하시더라</br>
<br>18 내가 이 두루마리의 예언의 말씀을 듣는 모든 사람에게 증언하노니 만일 누구든지 이것들 외에 더하면 하나님이 이 두루마리에 기록된 재앙들을 그에게 더하실 것이요</br>
<br>19 만일 누구든지 이 두루마리의 예언의 말씀에서 제하여 버리면 하나님이 이 두루마리에 기록된 생명나무와 및 거룩한 성에 참여함을 제하여 버리시리라</br>
<br>20 이것들을 증언하신 이가 이르시되 내가 진실로 속히 오리라 하시거늘 아멘 주 예수여 오시옵소서</br>
<br>21 주 예수의 은혜가 모든 자들에게 있을지어다 아멘</br>
<br>&nbsp;</br>
<br>    90 일차까지 통독을 모두 마치셨습니다.</br>
<br>&nbsp;</br>
<br> <marquee behavior=alternate scrollamount=3 width=500> 
👏👏👏 🎉 📖 <font color="#FF0000">축</font><font color="#FF7F50">하</font><font color="#FFD700">드</font><font color="#008000">립</font><font color="#0000FF">니</font><font color="#000080">다</font><font color="#800080">...</font> 📖 🎊 👏👏👏 
</marquee></br>
<br>&nbsp;</br>
      <br>&nbsp;</br>
      <br>&nbsp;</br>
      <br>&nbsp;</br>
      <br>&nbsp;</br>
      <br>&nbsp;</br>
    </h2>
  </div>

  <!-- 모달 (설명/요약 출력) -->
  <div id="explanation-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-content">
      <span class="close-button" id="close-modal" aria-label="닫기">&times;</span>
      <h3 id="modal-title">구절 설명</h3>
      <img id="modal-image" src="" alt="설명 관련 이미지" />
      <div id="modal-text">구절을 드래그하여 선택하고 '구절설명' 버튼을 누르세요.</div>
    </div>
  </div>

  <div id="scroll-marker-container" class="scroll-marker-container" aria-hidden="true"></div>

  <!-- 기도문 팝업 -->
  <div id="prayerToast" class="prayer-toast" role="dialog" aria-modal="false" aria-label="성경 읽기 전 기도문">
    <div class="prayer-header">
      <div class="prayer-title">
        <span>🙏</span>
        <span>기도하고 읽기</span>
        <span class="prayer-badge">90일 성경통톡</span>
      </div>
      <button class="prayer-close" id="prayerCloseBtn" aria-label="기도문 닫기">×</button>
    </div>

    <div class="prayer-body" id="prayerBody" tabindex="0">
   <style>
  .cross-red {
    color: red;
    font-weight: 900;
    -webkit-text-stroke: 0.6px currentColor; /* 윤곽선으로 두께 보강 */
    text-shadow:
      0 0 0 currentColor,         /* 기본 채움 */
      0.02em 0 currentColor, -0.02em 0 currentColor,
      0 0.02em currentColor,  0 -0.02em currentColor; /* 가장자리 두껍게 */
  }
</style>

<h4>
  <p>👀<span class="cross-red">✝︎</span> "하나님나라 관점" <span class="cross-red">✝︎</span>👀으로</p>
  <p>읽는 📖"90일 통큰통독"📖</p>
</h4>
<p>— 👦🏻 성경 읽기 전 1분 기도 🙏—</p>
<p>내 삶의 주인이 되시는 하나님, 성경을 읽게 하시니 감사합니다. 이 성경이 하나님의 말씀임을 믿습니다. 특별히 나에게 주시는 하나님의 말씀임을 믿습니다. 주시는 말씀을 내 관점으로 읽게 하지 마시고 하나님의 관점으로 읽어 하나님의 마음을 알게 하시고, 그 마음을 받아 나의 중심성을 하나님의 뜻 앞에 내려놓게 하시고 순종하게 하시어 변화되게 하옵소서, 말씀을 삶으로 이루는 성경 읽기가 되게 역사하여 주시옵소서. 예수님의 이름으로 기도합니다. 아멘.</p>
    
    </div>

    <div class="prayer-footer">
  <div></div> <!-- 좌측 자리 균형용(선택) -->
  <div class="prayer-actions">
    <button class="prayer-btn" id="prayerReadAlone">기도 드렸습니다</button>
    <button class="prayer-btn prayer-btn-primary" id="prayerAmen">확인</button>
  </div>
</div>

  <script>
    // ------------------------------
    // API KEY (사용자 입력 상태)
    const apiKey = "AIzaSyDUlSQlSPgnrFBXpnUJMDoUO3s_KsaoFRU";
    // ------------------------------

    // DOM
    const bibleTextEl = document.getElementById('bible-text');
    const searchCountEl = document.getElementById('search-count');
    const nextLocationBtn = document.getElementById('next-location-btn');
    const scrollMarkerContainer = document.getElementById('scroll-marker-container');

    const explanationIconButton = document.getElementById('explanation-icon-button');
    const explanationButtonWrapper = document.getElementById('explanation-button-wrapper');
    const explanationSubButtons = document.getElementById('explanation-sub-buttons');
    const detailedExplanationButton = document.getElementById('detailed-explanation-button');
    const simpleExplanationButton = document.getElementById('simple-explanation-button');

    const summarySimpleMain = document.getElementById('summary-simple-main');
    const summaryDetailedMain = document.getElementById('summary-detailed-main');

    const modal = document.getElementById('explanation-modal');
    const closeModalButton = document.getElementById('close-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalImage = document.getElementById('modal-image');
    const modalText = document.getElementById('modal-text');

    const audio = document.getElementById('audio-file');
    const playBtn = document.getElementById('play-btn');
    const pauseBtn = document.getElementById('pause-btn');
    const stopBtn = document.getElementById('stop-btn');
    const progressBar = document.getElementById('progress-bar');
    const rewindBtn = document.getElementById('rewind-10');
    const forwardBtn = document.getElementById('forward-10');
    const speedDisplay = document.getElementById('speed-display');
    const speedDown02Btn = document.getElementById('speed-down-02');
    const speedDown01Btn = document.getElementById('speed-down-01');
    const speedUp01Btn = document.getElementById('speed-up-01');
    const speedUp02Btn = document.getElementById('speed-up-02');
    const speedResetBtn = document.getElementById('speed-reset');
    const volumeSlider = document.getElementById('volume-slider');
    const muteBtn = document.getElementById('mute-btn');
    const currentTimeEl = document.getElementById('current-time');
    const remainingTimeEl = document.getElementById('remaining-time');

    const upBtn = document.getElementById('up');
    const downBtn = document.getElementById('down');
    const fontSizeEl = document.getElementById('font-size');

    // 상태
    let originalText = "";
    let selectedVerse = "";
    let selectionRange = null;
    let foundSentences = [];
    let currentSearchIndex = -1;
    let currentSpeed = 1.0;
    let isMuted = false;
    let selectionDebounce = null;

    function escapeRegExp(s) { return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }
    function formatTime(sec) { if (!isFinite(sec) || sec < 0) return '0:00'; const m = Math.floor(sec/60); const s = Math.floor(sec%60); return `${m}:${String(s).padStart(2,'0')}`; }

    window.addEventListener('DOMContentLoaded', () => {
      originalText = bibleTextEl.innerHTML;
      updateFontSizeDisplay();
      updateSpeed();

      // 본문 줄 단위 분리
      const lines = originalText.split(/<br\s*\/?>/i);
      bibleTextEl.innerHTML = lines.map(line => {
        if (line.trim() === "") return "<br>";
        return `<span class="line">${line}</span><br>`;
      }).join("");
      const lineElements = document.querySelectorAll("#bible-text .line");

           // 스크롤 시 중앙 강조 줄 수(2줄/3줄) 반응형으로 처리
function highlightCenterLines() {
  const viewportCenter = window.innerHeight / 2 + window.scrollY;
  const linesToHighlight = window.innerWidth >= 768 ? 3 : 2;

  let closestIndex = -1, minDistance = Infinity;
  lineElements.forEach((line, i) => {
    const rect = line.getBoundingClientRect();
    const lineCenter = rect.top + window.scrollY + rect.height / 2;
    const distance = Math.abs(lineCenter - viewportCenter);
    if (distance < minDistance) { minDistance = distance; closestIndex = i; }
  });

  lineElements.forEach(line => line.classList.remove("highlight"));
  if (closestIndex < 0) return;

  const indices = linesToHighlight === 3
    ? [closestIndex - 1, closestIndex, closestIndex + 1]
    : [closestIndex, closestIndex + 1];

  indices.forEach(idx => {
    if (idx >= 0 && idx < lineElements.length) {
      lineElements[idx].classList.add("highlight");
    }
  });
}

// rAF 스로틀
let ticking = false;
function onScrollOrResize() {
  if (ticking) return;
  ticking = true;
  requestAnimationFrame(() => {
    highlightCenterLines();
    ticking = false;
  });
}

// 이벤트 등록
window.addEventListener("scroll", onScrollOrResize, { passive: true });
window.addEventListener("resize", onScrollOrResize);
// (옵션) 기기 회전 이벤트도 묶어서 처리하면 좋아요
window.addEventListener("orientationchange", onScrollOrResize);

// 최초 1회 적용
highlightCenterLines();

      // PC에서 2줄씩 부드럽게 스크롤
      window.addEventListener("wheel", function(e) {
        if (e.ctrlKey) return;
        const modal = document.getElementById('explanation-modal');
        if (modal && modal.style.display === 'block' && modal.contains(e.target)) return;
        const firstLine = document.querySelector("#bible-text .line");
        if (!firstLine) return;
        const lineHeight = firstLine.getBoundingClientRect().height;
        e.preventDefault();
        window.scrollBy({ top: e.deltaY > 0 ? lineHeight * 2 : -lineHeight * 2, behavior: "smooth" });
      }, { passive: false });

      // 폰트 버튼
      upBtn.addEventListener('click', () => {
        const current = parseFloat(getComputedStyle(bibleTextEl).fontSize);
        if (current + 4 <= 80) { bibleTextEl.style.fontSize = (current + 4) + 'px'; updateFontSizeDisplay(); }
      });
      downBtn.addEventListener('click', () => {
        const current = parseFloat(getComputedStyle(bibleTextEl).fontSize);
        if (current - 4 >= 12) { bibleTextEl.style.fontSize = (current - 4) + 'px'; updateFontSizeDisplay(); }
      });

      // 검색
      const searchForm = document.forms.f1;
      searchForm.addEventListener('submit', (e) => { e.preventDefault(); findString(searchForm.t1.value); });
      searchForm.b2.addEventListener('click', () => { clearHighlight(); });
      nextLocationBtn.addEventListener('click', nextLocation);

      // 오디오
      playBtn.addEventListener('click', () => { audio.play().catch(()=>{}); });
      pauseBtn.addEventListener('click', () => audio.pause());
      stopBtn.addEventListener('click', () => { audio.pause(); audio.currentTime = 0; });
      speedDown02Btn.addEventListener('click', () => { currentSpeed = Math.max(0.5, currentSpeed - 0.2); updateSpeed(); });
      speedDown01Btn.addEventListener('click', () => { currentSpeed = Math.max(0.5, currentSpeed - 0.1); updateSpeed(); });
      speedUp01Btn.addEventListener('click', () => { currentSpeed = Math.min(2.0, currentSpeed + 0.1); updateSpeed(); });
      speedUp02Btn.addEventListener('click', () => { currentSpeed = Math.min(2.0, currentSpeed + 0.2); updateSpeed(); });
      speedResetBtn.addEventListener('click', () => { currentSpeed = 1.0; updateSpeed(); });
      volumeSlider.addEventListener('input', () => { audio.volume = Number(volumeSlider.value); });
      muteBtn.addEventListener('click', () => { isMuted = !isMuted; audio.muted = isMuted; muteBtn.textContent = isMuted ? '🔇' : '🔊'; });

      audio.addEventListener('timeupdate', () => {
        if (!isFinite(audio.duration) || audio.duration <= 0) return;
        const pct = (audio.currentTime / audio.duration) * 100;
        progressBar.value = pct;
        currentTimeEl.textContent = formatTime(audio.currentTime);
        remainingTimeEl.textContent = '-' + formatTime(audio.duration - audio.currentTime);
      }, { passive: true });
      audio.addEventListener('loadedmetadata', () => {
        currentTimeEl.textContent = '0:00';
        remainingTimeEl.textContent = '-' + formatTime(audio.duration || 0);
      });
      progressBar.addEventListener('input', () => {
        if (!isFinite(audio.duration) || audio.duration <= 0) return;
        const pct = progressBar.value / 100;
        audio.currentTime = audio.duration * pct;
      }, { passive: true });
      rewindBtn.addEventListener('click', () => { audio.currentTime = Math.max(0, audio.currentTime - 10); });
      forwardBtn.addEventListener('click', () => { if (isFinite(audio.duration)) audio.currentTime = Math.min(audio.duration, audio.currentTime + 10); });

      // 책 버튼 토글 & 선택 복원
      explanationIconButton.addEventListener('pointerdown', () => {
        const sel = window.getSelection();
        try { if (sel && sel.rangeCount > 0) selectionRange = sel.getRangeAt(0).cloneRange(); } catch(e) { selectionRange = null; }
      }, { passive: true });
      explanationIconButton.addEventListener('click', (ev) => {
        ev.stopPropagation();
        const sel = window.getSelection();
        try { if (sel && sel.rangeCount > 0) selectionRange = sel.getRangeAt(0).cloneRange(); } catch(e){ selectionRange = null; }
        explanationButtonWrapper.classList.toggle('active');
        setTimeout(() => {
          if (selectionRange) {
            const sel2 = window.getSelection();
            sel2.removeAllRanges();
            try { sel2.addRange(selectionRange); } catch(e){}
            updateSelectedVerseFromRange(selectionRange);
          }
        }, 60);
      });
      document.body.addEventListener('click', (ev) => {
        if (!explanationButtonWrapper.contains(ev.target)) explanationButtonWrapper.classList.remove('active');
      });

      // 구절 설명 버튼
      detailedExplanationButton.addEventListener('click', () => {
        const v = (selectedVerse || '').trim();
        if (!v) { showModal("구절을 먼저 선택하세요","본문에서 구절이나 단어를 드래그하여 선택한 후 다시 버튼을 눌러주세요."); }
        else { fetchExplanation(v, 'detailed'); }
        explanationButtonWrapper.classList.remove('active');
      });
      simpleExplanationButton.addEventListener('click', () => {
        const v = (selectedVerse || '').trim();
        if (!v) { showModal("구절을 먼저 선택하세요","본문에서 구절이나 단어를 드래그하여 선택한 후 다시 버튼을 눌러주세요."); }
        else { fetchExplanation(v, 'simple'); }
        explanationButtonWrapper.classList.remove('active');
      });

      // 본문 요약 버튼
      summarySimpleMain.addEventListener('click', () => {
        const full = getFullBibleText();
        if (!full.trim()) { showModal("본문이 없습니다","요약할 성경 본문이 없습니다."); }
        else { fetchSummary(full, 'simple'); }
      });
      summaryDetailedMain.addEventListener('click', () => {
        const full = getFullBibleText();
        if (!full.trim()) { showModal("본문이 없습니다","요약할 성경 본문이 없습니다."); }
        else { fetchSummary(full, 'detailed'); }
      });

      // 설명 모달 닫기
      closeModalButton.addEventListener('click', () => {
        modal.style.display = 'none';
        document.body.classList.remove('modal-open');
      });
      window.addEventListener('click', (ev) => {
        if (ev.target === modal) {
          modal.style.display = 'none';
          document.body.classList.remove('modal-open');
        }
      });

      // 선택 이벤트(디바운스)
      const scheduleSelectionUpdate = () => {
        clearTimeout(selectionDebounce);
        selectionDebounce = setTimeout(handleSelectionChange, 160);
      };
      document.addEventListener('mouseup', scheduleSelectionUpdate, { passive:true });
      document.addEventListener('touchend', scheduleSelectionUpdate, { passive:true });
      document.addEventListener('selectionchange', scheduleSelectionUpdate);

      // 기도문 팝업 초기화
      initPrayerToast();
    });

    // 선택 관리
    function handleSelectionChange(){
      const sel = window.getSelection();
      if (!sel) return clearSelectionState();
      const text = (sel.toString() || "").trim();

      const modalEl = document.getElementById('explanation-modal');
      if (modalEl && modalEl.style.display === 'block') {
        const sel2 = window.getSelection();
        if (sel2 && (modalEl.contains(sel2.anchorNode) || modalEl.contains(sel2.focusNode))) return;
      }

      let isInBible = false;
      try {
        if (sel.anchorNode && sel.focusNode) {
          isInBible = bibleTextEl.contains(sel.anchorNode) && bibleTextEl.contains(sel.focusNode);
        }
      } catch(e){ isInBible = false; }

      if (text && isInBible) {
        selectedVerse = text;
        try { selectionRange = sel.getRangeAt(0).cloneRange(); } catch(e){ selectionRange = null; }
        try {
          const range = sel.getRangeAt(0);
          const rects = Array.from(range.getClientRects());
          const rect = rects.length
            ? rects.reduce((u, r) => ({
                top: Math.min(u.top, r.top),
                left: Math.min(u.left, r.left),
                right: Math.max(u.right, r.right),
                bottom: Math.max(u.bottom, r.bottom),
                width: 0, height: 0
              }), { top:Infinity, left:Infinity, right:-Infinity, bottom:-Infinity })
            : range.getBoundingClientRect();
          rect.width  = rect.right - rect.left;
          rect.height = rect.bottom - rect.top;
          positionExplanationButton(rect);
        } catch(e){ resetExplanationButton(); }
      } else {
        clearSelectionState();
      }
    }
    function updateSelectedVerseFromRange(range) {
      if (!range) return;
      const txt = (range.toString() || "").trim();
      if (txt) selectedVerse = txt;
      try {
        const rect = range.getBoundingClientRect();
        positionExplanationButton(rect);
      } catch(e){ resetExplanationButton(); }
    }
    function resetExplanationButton(){
      const container = document.getElementById('explanation-button-container');
      if (!container) return;
      container.style.position = 'fixed';
      container.style.left = '30%';
      container.style.top = '100px';
      container.style.transform = 'translateX(-50%)';
      container.style.display = 'block';
      explanationButtonWrapper.classList.remove('active');
    }
    function clearSelectionState(){ selectedVerse = ""; selectionRange = null; resetExplanationButton(); }

    // 책 버튼 위치
    function positionExplanationButton(rect){
      const container = document.getElementById('explanation-button-container');
      if (!container) return;

      const vw = window.innerWidth;
      const vh = window.innerHeight;
      const margin = 8;
      const pad = 10;
      const viewportCenter = vw / 2;

      const isWide = rect.width >= vw * 0.6 || (rect.left <= margin*2 && rect.right >= vw - margin*2);

      let baseX, transformX;
      if (isWide) { baseX = rect.left + rect.width / 2; transformX = 'translateX(-50%)'; }
      else if (rect.left < viewportCenter * 0.4) { baseX = rect.right; transformX = 'translateX(0)'; }
      else if (rect.right > viewportCenter * 1.6) { baseX = rect.left; transformX = 'translateX(-100%)'; }
      else { baseX = rect.left + rect.width / 2; transformX = 'translateX(-50%)'; }

      const cw = container.offsetWidth || 60;
      const ch = container.offsetHeight || 60;

      const leftEdge =
        transformX === 'translateX(0)'     ? baseX :
        transformX === 'translateX(-50%)'  ? baseX - cw/2 :
                                             baseX - cw;

      let clampedLeftEdge = Math.min(Math.max(leftEdge, margin), vw - margin - cw);

      let finalLeft;
      if (transformX === 'translateX(0)')        finalLeft = clampedLeftEdge;
      else if (transformX === 'translateX(-50%)') finalLeft = clampedLeftEdge + cw/2;
      else                                        finalLeft = clampedLeftEdge + cw;

      let finalTop = rect.bottom + pad;
      if (finalTop + ch + margin > vh) finalTop = Math.max(rect.top - pad - ch, margin);
      finalTop = Math.min(Math.max(finalTop, margin), vh - margin - ch);

      container.style.position = 'fixed';
      container.style.left = `${finalLeft}px`;
      container.style.top  = `${finalTop}px`;
      container.style.transform = transformX;
      container.style.display = 'block';
    }

    // 검색
    function findString(searchText){
      clearHighlight();
      if (searchText == null || searchText.trim() === '') { searchCountEl.textContent = ''; nextLocationBtn.style.display = 'none'; return; }
      const escaped = escapeRegExp(searchText.trim());
      const regex = new RegExp(escaped, 'gi');
      const newContent = originalText.replace(regex, (match) => `<span class="search-highlight">${match}</span>`);
      bibleTextEl.innerHTML = newContent;
      foundSentences = Array.from(bibleTextEl.getElementsByClassName('search-highlight'));
      searchCountEl.textContent = `총 ${foundSentences.length}개 검색됨`;
      if (foundSentences.length > 0) {
        currentSearchIndex = 0;
        foundSentences[currentSearchIndex].scrollIntoView({ behavior:'smooth', block:'center' });
        nextLocationBtn.style.display = 'inline-block';
        updateScrollMarkers();
      } else {
        showModal("검색 결과 없음", `"${searchText}"에 대한 검색 결과가 없습니다.`);
        nextLocationBtn.style.display = 'none';
      }
    }
    function nextLocation(){
      if (!foundSentences.length) return;
      currentSearchIndex = (currentSearchIndex + 1) % foundSentences.length;
      foundSentences[currentSearchIndex].scrollIntoView({ behavior:'smooth', block:'center' });
      updateScrollMarkers();
    }
    function clearHighlight(){
      bibleTextEl.innerHTML = originalText;
      searchCountEl.textContent = '';
      nextLocationBtn.style.display = 'none';
      while (scrollMarkerContainer.firstChild) scrollMarkerContainer.removeChild(scrollMarkerContainer.firstChild);
      foundSentences = [];
      currentSearchIndex = -1;
    }
    function updateScrollMarkers(){
      while (scrollMarkerContainer.firstChild) scrollMarkerContainer.removeChild(scrollMarkerContainer.firstChild);
      const docH = document.documentElement.scrollHeight;
      const vh = window.innerHeight;
      foundSentences.forEach((el) => {
        const marker = document.createElement('div');
        marker.className = 'scroll-marker';
        const topPos = el.getBoundingClientRect().top + window.scrollY;
        const markerPos = Math.min(Math.max((topPos / docH) * vh, 2), vh - 10);
        marker.style.top = markerPos + 'px';
        marker.addEventListener('click', () => { el.scrollIntoView({ behavior:'smooth', block:'center' }); });
        scrollMarkerContainer.appendChild(marker);
      });
    }

    // 모달
    function showModal(title, text, imageUrl=null){
      modalTitle.textContent = title || '';
      modalText.innerHTML = (text || '').toString().replace(/\n/g, '<br>');
      if (imageUrl) { modalImage.src = imageUrl; modalImage.style.display = 'block'; } else { modalImage.src=''; modalImage.style.display='none'; }
      modal.style.display = 'block';
      document.body.classList.add('modal-open');
      setTimeout(() => {
        if (selectionRange) {
          const sel = window.getSelection();
          sel.removeAllRanges();
          try { sel.addRange(selectionRange); } catch(e) {}
        }
      }, 60);
    }
    function showLoadingModal(isImage=false){
      modalTitle.innerHTML = `<span class="loader"></span> ${isImage ? '그림 생성 중...' : '설명 생성 중...'}`;
      modalText.textContent = '설명을 생성 중입니다. 잠시만 기다려 주세요...';
      modalImage.style.display = 'none';
      modal.style.display = 'block';
    }

    modal.addEventListener('wheel', (e) => {
      if (modal.style.display === 'block') e.stopPropagation();
    }, { passive: true });

    function getFullBibleText(){
      const tmp = document.createElement('div');
      tmp.innerHTML = originalText;
      return tmp.textContent.replace(/\s+/g,' ').trim();
    }

    // Generative API 호출
    async function callGenerativeAPI(modalTitleText, prompt){
      const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
      const payload = { contents: [ { parts: [ { text: prompt } ] } ] };

      let retryCount = 0; const maxRetries = 3;
      let response = null;
      while (retryCount < maxRetries) {
        try {
          response = await fetch(apiUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          if (response.ok) break;
          if (response.status === 429) {
            retryCount++;
            const delay = Math.pow(2, retryCount)*1000 + Math.random()*1000;
            await new Promise(r=>setTimeout(r, delay));
          } else throw new Error(`API Error: ${response.status} ${response.statusText}`);
        } catch (err) {
          console.error('API call failed:', err);
          showModal("오류 발생", "API 호출 중 오류가 발생했습니다. 다시 시도해 주세요.");
          return;
        }
      }
      if (!response || !response.ok) { showModal("오류", "설명을 불러오는 데 실패했습니다. 잠시 후 다시 시도해 주세요."); return; }

      try {
        const data = await response.json();
        const content = data?.candidates?.[0]?.content?.parts?.[0]?.text || "응답을 가져오지 못했습니다.";
        showModal(modalTitleText, content);
      } catch (err) {
        console.error('Error processing response:', err);
        showModal("오류", "응답을 처리하는 중 오류가 발생했습니다.");
      }
    }

    async function fetchExplanation(promptText, type){
      let prompt;
      if (type === 'simple') {
        prompt = `[역할] 성경 주석가.
[작업] 선택한 용어/구절을 350–500자 한국어로 간결 설명.
[유형 규칙]
- 지명: 위치·시대·관련 사건
- 인물: 이름의 뜻·역할·연관 지명
- 제사/성물: 용도·상징적 의미
- 동·식물·광물: 상징성
필요 시 대비/유사 2–12가지만 간단히. (이름↔지명 직접 연결이 있으면 함께 언급)
[금지] 장황함·추측·인용.
[입력] "${promptText}"`;
      } else {
        prompt = `[역할] 성경 주석가.
[작업] 선택 구절을 2,500–3,500자 한국어 해설로 심화 분석.
[구성] 개요 → 배경(역사·지리·문화) → 본문 주제·핵심 논지 → 핵심 단어/도상 해석
→ 인물·사건·장소의 기능 → 성경 전체 맥락과의 연결(언약/교리, 유사·대조 2–12가지)
→ (선택) 3–6행 표로 요점 정리.
[규칙] 본문 근거 중심, 난해한 부분은 간명히, 과도한 인용/주석어/반복 금지, 분량 준수.
[긴 입력 시] 절/단락 단위로 요약 후 통합(최종 분량 준수).
[입력] "${promptText}"`;
      }
      showLoadingModal(false);
      await callGenerativeAPI('구절 설명', prompt);
    }

    async function fetchSummary(fullText, type){
      let prompt;
      if (type === 'simple') {
        prompt = `[역할] 성경 주석가.
[작업] 입력된 성경 본문 전체를 450–650자 한국어 한 단락으로 간결 요약.
[중점] 핵심 주제·메시지, 주요 사건 흐름, 하나님 행위/인간 반응. 배경은 한두 문장만. 삶 적용 2–3문장 추가.
[금지] 장황함·추측·인용·소제목·서론/결론 문구. 분량 엄수.
[긴 입력 시] 장 단위로 요약→최종 450–650자로 통합.
[입력] "${fullText}"`;
      } else {
        prompt = `[역할] 성경 주석가.
[작업] 입력 본문을 3,500–5,000자 한국어 해설로 정리.
[구성] 1) 개요  2) 배경(역사·지리·문화)  3) 핵심 주제/신학적 의미
4) 인물·사건·장소의 역할  5) 성경 전체 맥락과 연결(필요 시 유사/대조 2–12가지)
6) (선택) 3–12행 표로 핵심 정리.  7) 결론  8) 삶 적용 4–5문장.
[규칙] 사실 기반, 과장/추측/설교체 금지, 불필요한 반복 금지, 분량 준수.
[긴 입력 시] 장 단위로 개요→통합(최종 분량 준수).
[입력] "${fullText}"`;
      }
      showLoadingModal(false);
      await callGenerativeAPI('본문 요약', prompt);
    }

    function updateSpeed(){ audio.playbackRate = currentSpeed; speedDisplay.textContent = currentSpeed.toFixed(1) + 'x'; }
    function updateFontSizeDisplay(){ const cur = parseFloat(getComputedStyle(bibleTextEl).fontSize); fontSizeEl.textContent = Math.round(cur); }

    // 토글 버튼 로직
    const progressContainer = document.querySelector('.progress-container');
    const speedControls = document.querySelector('.speed-controls');
    const volumeControl = document.querySelector('.volume-control');
    const showProgressBtn = document.getElementById('show-progress');
    const showSpeedBtn = document.getElementById('show-speed');
    const showVolumeBtn = document.getElementById('show-volume');
    let hideTimeout;
    function showOnly(target) {
      progressContainer.style.display = "none";
      speedControls.style.display = "none";
      volumeControl.style.display = "none";
      target.style.display = "flex";
      if (hideTimeout) clearTimeout(hideTimeout);
      hideTimeout = setTimeout(() => { target.style.display = "none"; }, 10000);
    }
    showProgressBtn.addEventListener('click', () => showOnly(progressContainer));
    showSpeedBtn.addEventListener('click', () => showOnly(speedControls));
    showVolumeBtn.addEventListener('click', () => showOnly(volumeControl));

    // ===== 기도문 팝업 제어 =====
  function initPrayerToast(){
  const toast = document.getElementById('prayerToast');
  const closeBtn = document.getElementById('prayerCloseBtn');
  const amenBtn = document.getElementById('prayerAmen');
  const readBtn = document.getElementById('prayerReadAlone');

  const isSiteModalOpen = () => document.body.classList.contains('modal-open');

  function openToast(){
    if (!toast) return;
    if (isSiteModalOpen()) return;            // 사이트 모달이 열려 있으면 숨김
    toast.style.display = 'block';
    document.getElementById('prayerBody')?.focus({ preventScroll:true });
  }
  function closeToast(){
    if (!toast) return;
    toast.style.display = 'none';             // 저장/기억 없음 → 다음 방문 시 다시 표시
  }

  // 페이지 로드 시 항상 표시 (약간 지연)
  setTimeout(openToast, 700);

  // 버튼 동작: 전부 단순 닫기
  closeBtn?.addEventListener('click', () => closeToast());
  amenBtn?.addEventListener('click', () => closeToast());
  readBtn?.addEventListener('click', () => closeToast());

  // 사이트 모달 열림/닫힘에 따라 토스트 표시/숨김
  const observer = new MutationObserver(() => {
    if (isSiteModalOpen()) {
      toast.style.display = 'none';
    } else {
      // 모달이 닫히면 다시 보여줌(사용자가 이미 닫았더라도 새로고침/재방문 시 다시 뜨게 하려면 유지)
      if (toast.style.display !== 'block') toast.style.display = 'block';
    }
  });
  observer.observe(document.body, { attributes:true, attributeFilter:['class'] });
}
  </script>
</body>
</html>

