<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>통큰통독-02일차</title>
  <link rel="apple-touch-icon" type="image/png" href="https://i.postimg.cc/Qtnq0gFJ/Ezra-icon.png">
  <meta name="apple-mobile-web-app-title" content="통큰통독">
  <link rel="shortcut icon" type="image/png" href="https://i.postimg.cc/Qtnq0gFJ/Ezra-icon.png">
  <link rel="mask-icon" type="image/png" href="https://i.postimg.cc/Qtnq0gFJ/Ezra-icon.png">

  <style>
    /* ---------------------------
       전체 스타일 (원 디자인 유지)
       --------------------------- */
    :root{
      --blue:#007BFF;
      --pink:#ff99cc;
      --shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html,body { height:100%; margin:0; padding:0; font-family: Arial, sans-serif; -webkit-font-smoothing:antialiased; }
    body { padding-top:150px; background:#fff; color:#000; }

    a:link { color:#0000FF; } a:visited{ color:#660099; }

    /* 상단 고정 테이블 */
    .top-fixed-table {
      position: fixed; top:0; left:0; width:100%; background:transparent; border-bottom:none; z-index:100;
      table-layout: fixed; padding:10px 0; box-sizing:border-box;
    }
    .search-cell { text-align:left; padding-left:10px; vertical-align:top; width:30%; }
    .search-cell input[type="text"]{ width:50%; font-size:12pt; }
    .search-cell input[type="submit"], .search-cell input[type="reset"]{ font-size:10pt; padding:5px 8px; height:auto; }

    .audio-cell { text-align:right; padding-right:50px; vertical-align:top; width:30%; }
    #custom-audio-player { display:flex; flex-direction:column; align-items:center; }
    .player-controls{ display:flex; align-items:center; justify-content:center; gap:10px; margin-bottom:5px; }
    .time-display{ font-size:16px; font-weight:bold; color:black; margin:0 5px; min-width:44px; text-align:center; }

    .progress-container { display: flex; align-items: center; justify-content: center; gap: 6px; margin: 6px 0; }
    .skip-btn { width: 48px; height: 28px; font-size: 13px; cursor: pointer; border: 1px solid #ccc; border-radius: 5px; background: #fff; }
    .skip-btn:hover { background: #e0e0e0; }

    .control-btn{ width:28px; height:28px; font-size:14px; cursor:pointer; border:1px solid #ccc; background:#fff; border-radius:5px; }
    .control-btn:hover{ background:#e0e0e0; }
    #play-btn{ background:#d1f3d4; } #pause-btn{ background:#fff6d6; } #stop-btn{ background:#fddddd; }

    .speed-controls{ display:flex; align-items:center; justify-content:center; gap:5px; margin-bottom:5px; }
    .speed-btn{ width:21px; height:21px; font-size:10px; cursor:pointer; border:1px solid #ccc; border-radius:3px; background:#fff; }
    .speed-btn:hover{ background:#e0e0e0; }
    .speed-display{ font-weight:bold; color:var(--blue); width:50px; text-align:center; }

    .volume-control{ display:flex; align-items:center; justify-content:center; gap:5px; }
    input[type="range"]{ -webkit-appearance:none; width:160px; height:5px; background:#d3d3d3; outline:none; opacity:0.9; transition:opacity .2s; border-radius:3px;}
    input[type="range"]::-webkit-slider-thumb{ -webkit-appearance:none; appearance:none; width:15px; height:15px; background:var(--blue); border-radius:50%; cursor:pointer; }

    /* progress */
    #progress-bar { width: 60%; max-width: 100px; }

    /* volume */
    #volume-slider { width: 80%; max-width: 120px; }

    /* 설명 버튼 컨테이너 (플로팅) */
    .explanation-button-container{ position:fixed; top:100px; left:30%; transform:translateX(-50%); z-index:100; display:block; padding:0 10px; transition:top .2s ease,left .2s ease,transform .2s ease; }
    .explanation-button-wrapper{ position:relative; display:inline-block; cursor:pointer; }
    .explanation-icon-button{ width:50px; height:50px; border-radius:50%; background:var(--pink); box-shadow:var(--shadow); border:none; display:flex; align-items:center; justify-content:center; font-size:40px; z-index:2; }
    .explanation-sub-buttons{ display:flex; flex-direction:column; gap:10px; opacity:0; visibility:hidden; transition:opacity .3s ease,visibility .3s ease, transform .3s ease; position:absolute; left:45%; transform:translateX(-50%) translateY(25px); z-index:1; }
    .explanation-button-wrapper.active .explanation-sub-buttons{ opacity:1; visibility:visible; transform:translateX(-50%) translateY(0); }
    .explanation-sub-button{ padding:5px 10px; font-size:18px; background:var(--pink); border:none; border-radius:5px; cursor:pointer; box-shadow:var(--shadow); white-space:nowrap; }
    .explanation-sub-button:hover{ transform:scale(1.03); }

    /* 폰트 사이즈 및 본문 요약 버튼 (항상 표시) */
    .container{ width:100%; text-align:center; margin-top:8px; }
    .font-size-label{ font-size:20px !important; margin-right:12px; font-weight:bold; color:blue; display:inline-block; vertical-align:middle; }
    #font-size{ font-size:20px !important; margin:0 8px; font-weight:bold; color:red; display:inline-block; vertical-align:middle; width:48px; }
    #down,#up{ width:27px; height:27px; font-size:20px; color:red; background:#fff; border:1px solid #ccc; border-radius:5px; cursor:pointer; display:inline-block; vertical-align:middle; }

    /* 본문 요약 버튼 - 항상 노출 (요구사항) */
    .summary-buttons { display:inline-block; margin-left:16px; vertical-align:middle; }
    .summary-btn { padding:6px 10px; margin-left:6px; font-size:14px; border-radius:6px; border:1px solid #ccc; background:#fff; cursor:pointer; }
    .summary-btn:hover{ background:#f2f2f2; }

    /* 본문 */
    h2{ padding:0; text-align:left; margin-left:15px; margin-right:15px; }
    p{ display:inline-block; }

    /* 모달 */
    .modal{ display:none; position:fixed; z-index:200; inset:0; width:100%; height:100%; overflow:auto; background:rgba(0,0,0,0.4); }
    .modal-content{ background:#fff; margin:12% auto; padding:20px; border-radius:10px; width:80%; max-width:900px; box-shadow:0 4px 8px rgba(0,0,0,0.2); text-align:left; line-height:1.6; word-break:keep-all; white-space:pre-wrap; }
    .close-button{ color:#aaa; float:right; font-size:28px; font-weight:bold; cursor:pointer; }
    .close-button:hover{ color:#000; }
    #modal-image{ max-width:100%; height:auto; margin-bottom:12px; display:none; border-radius:8px; }

    /* 로딩 스피너 */
    .loader{ border:4px solid #f3f3f3; border-top:4px solid #3498db; border-radius:50%; width:20px; height:20px; animation:spin 1s linear infinite; display:inline-block; vertical-align:middle; margin-right:8px; }
    @keyframes spin{ 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }

    /* 스크롤 마커 */
    .search-highlight{ background:yellow; color:#000; }
    .scroll-marker-container{ position:fixed; top:0; right:0; width:8px; height:100vh; z-index:99; pointer-events:none; }
    .scroll-marker{ position:absolute; right:0; width:8px; height:8px; background:red; border-radius:50%; box-shadow:0 0 5px rgba(255,0,0,0.7); cursor:pointer; pointer-events:auto; }
    .scroll-marker:hover{ transform:scale(1.5); transition:transform .2s ease; }

    /* 선택 관련 (iOS) */
    #bible-text{ -webkit-user-select:text; user-select:text; -webkit-touch-callout:none; }

    /* 반응형 보완 */
    @media (max-width:800px){
      .search-cell{ width:55%; } .audio-cell{ width:45%; } .search-cell input[type="text"]{ width:60%; } #progress-bar{ width:160px; }
    }
    @media (max-width:600px){
      .search-cell input[type="text"]{ width:68%; font-size:11pt; } .time-display{ font-size:13px; } #progress-bar{ width:140px; }
      .explanation-sub-button{ font-size:16px; padding:6px 8px; }
      .explanation-icon-button{ width:46px; height:46px; font-size:34px; }
      .summary-btn{ padding:5px 8px; font-size:13px; }
    }

     /* --- 새 버튼 그룹 스타일 --- */
    .toggle-buttons {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 6px;
    }
    .toggle-buttons button {
      padding: 4px 8px;
      font-size: 13px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background: #fff;
      cursor: pointer;
    }
    .toggle-buttons button:hover {
      background: #f0f0f0;
    }
  </style>
</head>
<body>
  <!-- 상단: 검색 + 오디오 -->
  <table class="top-fixed-table" id="main-table" cellpadding="0" cellspacing="0">
    <tr>
      <td class="search-cell">
        <form name="f1" action="">
          <input type="reset" name="b2" value="X">
          <input type="text" placeholder="검색어를 입력하세요" name="t1" value="">
          <input type="submit" name="b1" value="검색">
          <div id="search-count-container">
            <span id="search-count"></span>
            <button type="button" id="next-location-btn" style="display:none;">다음 위치</button>
          </div>
        </form>
      </td>
      
       <td class="audio-cell">
        <div id="custom-audio-player" role="region" aria-label="오디오 플레이어">
          <audio id="audio-file" preload="auto" playsinline>
            <source src="https://vod47.anyline.co.kr/vod_ezra/%EC%9D%BD%EA%B8%B0%2002.mp3" type="audio/mpeg">
            브라우저가 오디오 요소를 지원하지 않습니다.
          </audio>

          <!-- 기본 컨트롤 -->
          <div class="player-controls">
            <strong><span style="font-size:16px; background-color: #fcfcfc;" id="current-time" class="time-display">0:00</span></strong>
            <button id="play-btn" class="control-btn" aria-label="재생">▶</button>
            <button id="pause-btn" class="control-btn" aria-label="일시정지">⏸</button>
            <button id="stop-btn" class="control-btn" aria-label="정지">■</button>
            <strong><span style="font-size:16px; background-color: #fcfcfc;" id="remaining-time" class="time-display">0:00</span></strong>
          </div>

          <!-- ✅ 새 버튼 그룹 -->
          <div class="toggle-buttons">
            <button id="show-progress">재생 위치</button>
            <button id="show-speed">재생 속도</button>
            <button id="show-volume">볼륨 조절</button>
          </div>

          <!-- 기본은 숨김 -->
          <div class="progress-container" style="display:none;">
            <button id="rewind-10" class="skip-btn">⏪10s</button>
            <input type="range" id="progress-bar" min="0" max="100" value="0" step="0.01" aria-label="재생 위치">
            <button id="forward-10" class="skip-btn">10s⏩</button>
          </div>

          <div class="speed-controls" style="display:none;">
            <button id="speed-down-02" class="speed-btn">&laquo;</button>
            <button id="speed-down-01" class="speed-btn">&lt;</button>
            <span id="speed-display" class="speed-display">1.0x</span>
            <button id="speed-up-01" class="speed-btn">&gt;</button>
            <button id="speed-up-02" class="speed-btn">&raquo;</button>
            <button id="speed-reset">1.0</button>
          </div>

          <div class="volume-control" style="display:none;">
            <span style="font-size:14px;">볼륨</span>
            <button id="mute-btn">🔊</button>
            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
          </div>
        </div>
      </td>
    </tr>
  </table>

  <!-- 플로팅 책 버튼 (구절설명 토글) -->
  <div class="explanation-button-container" id="explanation-button-container">
    <div class="explanation-button-wrapper" id="explanation-button-wrapper">
      <button class="explanation-icon-button" id="explanation-icon-button" aria-label="구절설명 열기">
        <span>📖</span>
      </button>
      <div class="explanation-sub-buttons" id="explanation-sub-buttons" role="menu">
        <button class="explanation-sub-button" id="detailed-explanation-button">상세 구절설명</button>
        <button class="explanation-sub-button" id="simple-explanation-button">간단 구절설명</button>
      </div>
    </div>
  </div>

  <!-- 폰트 크기 + 항상 표시되는 본문 요약 버튼 -->
  <div class="container" style="margin-top:6px;">
    <p class="font-size-label">Font Size</p>
    <button id="down">-</button>
    <p id="font-size">20</p>
    <button id="up">+</button>

    <span class="summary-buttons" aria-hidden="false">
      <button class="summary-btn" id="summary-simple-main">본문요약 간단</button>
      <button class="summary-btn" id="summary-detailed-main">본문요약 상세</button>
    </span>
  </div>

  <!-- 본문 (원문 유지: <br></br> 포함) -->
  <div>
    <h2 id="bible-text" style="line-height:1.2em;margin-left:15px;margin-right:15px;font-style:normal;font-weight:normal;color:black;font-size:20px;word-break:break-all;">
      <strong>

통독 2일차
<br>범위: 창세기 12장- 23장</br>
<br>&nbsp;</br>

</strong>
<strong><br><font color="#4682b4">창세기 12 장</font></br></strong>
<br><i><font color="#808080">*여호와께서 아브람에게 이르시다*</font></i></br>
<br>1 여호와께서 아브람에게 이르시되 너는 너의 고향과 친척과 아버지의 집을 떠나 내가 네게 보여 줄 땅으로 가라</br>
<br>2 내가 너로 큰 민족을 이루고 네게 복을 주어 네 이름을 창대하게 하리니 너는 복이 될지라</br>
<br>3 너를 축복하는 자에게는 내가 복을 내리고 너를 저주하는 자에게는 내가 저주하리니 땅의 모든 족속이 너로 말미암아 복을 얻을 것이라 하신지라</br>
<br>4 이에 아브람이 여호와의 말씀을 따라갔고 롯도 그와 함께 갔으며 아브람이 하란을 떠날 때에 칠십오 세였더라</br>
<br>5 아브람이 그의 아내 사래와 조카 롯과 하란에서 모은 모든 소유와 얻은 사람들을 이끌고 가나안 땅으로 가려고 떠나서 마침내 가나안 땅에 들어갔더라</br>
<br>6 아브람이 그 땅을 지나 세겜 땅 모레 상수리나무에 이르니 그 때에 가나안 사람이 그 땅에 거주하였더라</br>
<br>7 여호와께서 아브람에게 나타나 이르시되 내가 이 땅을 네 자손에게 주리라 하신지라 자기에게 나타나신 여호와께 그가 그 곳에서 제단을 쌓고</br>
<br>8 거기서 벧엘 동쪽 산으로 옮겨 장막을 치니 서쪽은 벧엘이요 동쪽은 아이라 그가 그 곳에서 여호와께 제단을 쌓고 여호와의 이름을 부르더니</br>
<br>9 점점 남방으로 옮겨갔더라</br>
<br><i><font color="#808080">*아브람이 애굽으로 내려가다*</font></i></br>
<br>10 그 땅에 기근이 들었으므로 아브람이 애굽에 거류하려고 그리로 내려갔으니 이는 그 땅에 기근이 심하였음이라</br>
<br>11 그가 애굽에 가까이 이르렀을 때에 그의 아내 사래에게 말하되 내가 알기에 그대는 아리따운 여인이라</br>
<br>12 애굽 사람이 그대를 볼 때에 이르기를 이는 그의 아내라 하여 나는 죽이고 그대는 살리리니</br>
<br>13 원하건대 그대는 나의 누이라 하라 그러면 내가 그대로 말미암아 안전하고 내 목숨이 그대로 말미암아 보존되리라 하니라</br>
<br>14 아브람이 애굽에 이르렀을 때에 애굽 사람들이 그 여인이 심히 아리따움을 보았고</br>
<br>15 바로의 고관들도 그를 보고 바로 앞에서 칭찬하므로 그 여인을 바로의 궁으로 이끌어들인지라</br>
<br>16 이에 바로가 그로 말미암아 아브람을 후대하므로 아브람이 양과 소와 노비와 암수 나귀와 낙타를 얻었더라</br>
<br>17 여호와께서 아브람의 아내 사래의 일로 바로와 그 집에 큰 재앙을 내리신지라</br>
<br>18 바로가 아브람을 불러서 이르되 네가 어찌하여 나에게 이렇게 행하였느냐 네가 어찌하여 그를 네 아내라고 내게 말하지 아니하였느냐</br>
<br>19 네가 어찌 그를 누이라 하여 내가 그를 데려다가 아내를 삼게 하였느냐 네 아내가 여기 있으니 이제 데려가라 하고</br>
<br>20 바로가 사람들에게 그의 일을 명하매 그들이 그와 함께 그의 아내와 그의 모든 소유를 보내었더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 13 장</font></br></strong>
<br><i><font color="#808080">*아브람과 롯이 서로 떠나다*</font></i></br>
<br>1 아브람이 애굽에서 그와 그의 아내와 모든 소유와 롯과 함께 네게브로 올라가니</br>
<br>2 아브람에게 가축과 은과 금이 풍부하였더라</br>
<br>3 그가 네게브에서부터 길을 떠나 벧엘에 이르며 벧엘과 아이 사이 곧 전에 장막 쳤던 곳에 이르니</br>
<br>4 그가 처음으로 제단을 쌓은 곳이라 그가 거기서 여호와의 이름을 불렀더라</br>
<br>5 아브람의 일행 롯도 양과 소와 장막이 있으므로</br>
<br>6 그 땅이 그들이 동거하기에 넉넉하지 못하였으니 이는 그들의 소유가 많아서 동거할 수 없었음이니라</br>
<br>7 그러므로 아브람의 가축의 목자와 롯의 가축의 목자가 서로 다투고 또 가나안 사람과 브리스 사람도 그 땅에 거주하였는지라</br>
<br>8 아브람이 롯에게 이르되 우리는 한 친족이라 나나 너나 내 목자나 네 목자나 서로 다투게 하지 말자</br>
<br>9 네 앞에 온 땅이 있지 아니하냐 나를 떠나가라 네가 좌하면 나는 우하고 네가 우하면 나는 좌하리라</br>
<br>10 이에 롯이 눈을 들어 요단 지역을 바라본즉 소알까지 온 땅에 물이 넉넉하니 여호와께서 소돔과 고모라를 멸하시기 전이었으므로 여호와의 동산 같고 애굽 땅과 같았더라</br>
<br>11 그러므로 롯이 요단 온 지역을 택하고 동으로 옮기니 그들이 서로 떠난지라</br>
<br>12 아브람은 가나안 땅에 거주하였고 롯은 그 지역의 도시들에 머무르며 그 장막을 옮겨 소돔까지 이르렀더라</br>
<br>13 소돔 사람은 여호와 앞에 악하며 큰 죄인이었더라</br>
<br><i><font color="#808080">*아브람이 헤브론으로 옮기다*</font></i></br>
<br>14 롯이 아브람을 떠난 후에 여호와께서 아브람에게 이르시되 너는 눈을 들어 너 있는 곳에서 북쪽과 남쪽 그리고 동쪽과 서쪽을 바라보라</br>
<br>15 보이는 땅을 내가 너와 네 자손에게 주리니 영원히 이르리라</br>
<br>16 내가 네 자손이 땅의 티끌 같게 하리니 사람이 땅의 티끌을 능히 셀 수 있을진대 네 자손도 세리라</br>
<br>17 너는 일어나 그 땅을 종과 횡으로 두루 다녀 보라 내가 그것을 네게 주리라</br>
<br>18 이에 아브람이 장막을 옮겨 헤브론에 있는 마므레 상수리 수풀에 이르러 거주하며 거기서 여호와를 위하여 제단을 쌓았더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 14 장</font></br></strong>
<br><i><font color="#808080">*아브람이 롯을 구하다*</font></i></br>
<br>1 당시에 시날 왕 아므라벨과 엘라살 왕 아리옥과 엘람 왕 그돌라오멜과 고임 왕 디달이</br>
<br>2 소돔 왕 베라와 고모라 왕 비르사와 아드마 왕 시납과 스보임 왕 세메벨과 벨라 곧 소알 왕과 싸우니라</br>
<br>3 이들이 다 싯딤 골짜기 곧 지금의 염해에 모였더라</br>
<br>4 이들이 십이 년 동안 그돌라오멜을 섬기다가 제십삼년에 배반한지라</br>
<br>5 제십사년에 그돌라오멜과 그와 함께 한 왕들이 나와서 아스드롯 가르나임에서 르바 족속을, 함에서 수스 족속을, 사웨 기랴다임에서 엠 족속을 치고</br>
<br>6 호리 족속을 그 산 세일에서 쳐서 광야 근방 엘바란까지 이르렀으며</br>
<br>7 그들이 돌이켜 엔미스밧 곧 가데스에 이르러 아말렉 족속의 온 땅과 하사손다말에 사는 아모리 족속을 친지라</br>
<br>8 소돔 왕과 고모라 왕과 아드마 왕과 스보임 왕과 벨라 곧 소알 왕이 나와서 싯딤 골짜기에서 그들과 전쟁을 하기 위하여 진을 쳤더니</br>
<br>9 엘람 왕 그돌라오멜과 고임 왕 디달과 시날 왕 아므라벨과 엘라살 왕 아리옥 네 왕이 곧 그 다섯 왕과 맞서니라</br>
<br>10 싯딤 골짜기에는 역청 구덩이가 많은지라 소돔 왕과 고모라 왕이 달아날 때에 그들이 거기 빠지고 그 나머지는 산으로 도망하매</br>
<br>11 네 왕이 소돔과 고모라의 모든 재물과 양식을 빼앗아 가고</br>
<br>12 소돔에 거주하는 아브람의 조카 롯도 사로잡고 그 재물까지 노략하여 갔더라</br>
<br>13 도망한 자가 와서 히브리 사람 아브람에게 알리니 그 때에 아브람이 아모리 족속 마므레의 상수리 수풀 근처에 거주하였더라 마므레는 에스골의 형제요 또 아넬의 형제라 이들은 아브람과 동맹한 사람들이더라</br>
<br>14 아브람이 그의 조카가 사로잡혔음을 듣고 집에서 길리고 훈련된 자 삼백십팔 명을 거느리고 단까지 쫓아가서</br>
<br>15 그와 그의 가신들이 나뉘어 밤에 그들을 쳐부수고 다메섹 왼편 호바까지 쫓아가</br>
<br>16 모든 빼앗겼던 재물과 자기의 조카 롯과 그의 재물과 또 부녀와 친척을 다 찾아왔더라</br>
<br><i><font color="#808080">*멜기세덱이 아브람에게 축복하다*</font></i></br>
<br>17 아브람이 그돌라오멜과 그와 함께 한 왕들을 쳐부수고 돌아올 때에 소돔 왕이 사웨 골짜기 곧 왕의 골짜기로 나와 그를 영접하였고</br>
<br>18 살렘 왕 멜기세덱이 떡과 포도주를 가지고 나왔으니 그는 지극히 높으신 하나님의 제사장이었더라</br>
<br>19 그가 아브람에게 축복하여 이르되 천지의 주재이시요 지극히 높으신 하나님이여 아브람에게 복을 주옵소서</br>
<br>20 너희 대적을 네 손에 붙이신 지극히 높으신 하나님을 찬송할지로다 하매 아브람이 그 얻은 것에서 십분의 일을 멜기세덱에게 주었더라</br>
<br>21 소돔 왕이 아브람에게 이르되 사람은 내게 보내고 물품은 네가 가지라</br>
<br>22 아브람이 소돔 왕에게 이르되 천지의 주재이시요 지극히 높으신 하나님 여호와께 내가 손을 들어 맹세하노니</br>
<br>23 네 말이 내가 아브람으로 치부하게 하였다 할까 하여 네게 속한 것은 실 한 오라기나 들메끈 한 가닥도 내가 가지지 아니하리라</br>
<br>24 오직 젊은이들이 먹은 것과 나와 동행한 아넬과 에스골과 마므레의 분깃을 제할지니 그들이 그 분깃을 가질 것이니라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 15 장</font></br></strong>
<br><i><font color="#808080">*여호와께서 아브람과 언약을 세우시다*</font></i></br>
<br>1 이 후에 여호와의 말씀이 환상 중에 아브람에게 임하여 이르시되 아브람아 두려워하지 말라 나는 네 방패요 너의 지극히 큰 상급이니라</br>
<br>2 아브람이 이르되 주 여호와여 무엇을 내게 주시려 하나이까 나는 자식이 없사오니 나의 상속자는 이 다메섹 사람 엘리에셀이니이다</br>
<br>3 아브람이 또 이르되 주께서 내게 씨를 주지 아니하셨으니 내 집에서 길린 자가 내 상속자가 될 것이니이다</br>
<br>4 여호와의 말씀이 그에게 임하여 이르시되 그 사람이 네 상속자가 아니라 네 몸에서 날 자가 네 상속자가 되리라 하시고</br>
<br>5 그를 이끌고 밖으로 나가 이르시되 하늘을 우러러 뭇별을 셀 수 있나 보라 또 그에게 이르시되 네 자손이 이와 같으리라</br>
<br>6 아브람이 여호와를 믿으니 여호와께서 이를 그의 의로 여기시고</br>
<br>7 또 그에게 이르시되 나는 이 땅을 네게 주어 소유를 삼게 하려고 너를 갈대아인의 우르에서 이끌어 낸 여호와니라</br>
<br>8 그가 이르되 주 여호와여 내가 이 땅을 소유로 받을 것을 무엇으로 알리이까</br>
<br>9 여호와께서 그에게 이르시되 나를 위하여 삼 년 된 암소와 삼 년 된 암염소와 삼 년 된 숫양과 산비둘기와 집비둘기 새끼를 가져올지니라</br>
<br>10 아브람이 그 모든 것을 가져다가 그 중간을 쪼개고 그 쪼갠 것을 마주 대하여 놓고 그 새는 쪼개지 아니하였으며</br>
<br>11 솔개가 그 사체 위에 내릴 때에는 아브람이 쫓았더라</br>
<br>12 해 질 때에 아브람에게 깊은 잠이 임하고 큰 흑암과 두려움이 그에게 임하였더니</br>
<br>13 여호와께서 아브람에게 이르시되 너는 반드시 알라 네 자손이 이방에서 객이 되어 그들을 섬기겠고 그들은 사백 년 동안 네 자손을 괴롭히리니</br>
<br>14 그들이 섬기는 나라를 내가 징벌할지며 그 후에 네 자손이 큰 재물을 이끌고 나오리라</br>
<br>15 너는 장수하다가 평안히 조상에게로 돌아가 장사될 것이요</br>
<br>16 네 자손은 사대 만에 이 땅으로 돌아오리니 이는 아모리 족속의 죄악이 아직 가득 차지 아니함이니라 하시더니</br>
<br>17 해가 져서 어두울 때에 연기 나는 화로가 보이며 타는 횃불이 쪼갠 고기 사이로 지나더라</br>
<br>18 그 날에 여호와께서 아브람과 더불어 언약을 세워 이르시되 내가 이 땅을 애굽 강에서부터 그 큰 강 유브라데까지 네 자손에게 주노니</br>
<br>19 곧 겐 족속과 그니스 족속과 갓몬 족속과</br>
<br>20 헷 족속과 브리스 족속과 르바 족속과</br>
<br>21 아모리 족속과 가나안 족속과 기르가스 족속과 여부스 족속의 땅이니라 하셨더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 16 장</font></br></strong>
<br><i><font color="#808080">*하갈과 이스마엘*</font></i></br>
<br>1 아브람의 아내 사래는 출산하지 못하였고 그에게 한 여종이 있으니 애굽 사람이요 이름은 하갈이라</br>
<br>2 사래가 아브람에게 이르되 여호와께서 내 출산을 허락하지 아니하셨으니 원하건대 내 여종에게 들어가라 내가 혹 그로 말미암아 자녀를 얻을까 하노라 하매 아브람이 사래의 말을 들으니라</br>
<br>3 아브람의 아내 사래가 그 여종 애굽 사람 하갈을 데려다가 그 남편 아브람에게 첩으로 준 때는 아브람이 가나안 땅에 거주한 지 십 년 후였더라</br>
<br>4 아브람이 하갈과 동침하였더니 하갈이 임신하매 그가 자기의 임신함을 알고 그의 여주인을 멸시한지라</br>
<br>5 사래가 아브람에게 이르되 내가 받는 모욕은 당신이 받아야 옳도다 내가 나의 여종을 당신의 품에 두었거늘 그가 자기의 임신함을 알고 나를 멸시하니 당신과 나 사이에 여호와께서 판단하시기를 원하노라</br>
<br>6 아브람이 사래에게 이르되 당신의 여종은 당신의 수중에 있으니 당신의 눈에 좋을 대로 그에게 행하라 하매 사래가 하갈을 학대하였더니 하갈이 사래 앞에서 도망하였더라</br>
<br>7 여호와의 사자가 광야의 샘물 곁 곧 술 길 샘 곁에서 그를 만나</br>
<br>8 이르되 사래의 여종 하갈아 네가 어디서 왔으며 어디로 가느냐 그가 이르되 나는 내 여주인 사래를 피하여 도망하나이다</br>
<br>9 여호와의 사자가 그에게 이르되 네 여주인에게로 돌아가서 그 수하에 복종하라</br>
<br>10 여호와의 사자가 또 그에게 이르되 내가 네 씨를 크게 번성하여 그 수가 많아 셀 수 없게 하리라</br>
<br>11 여호와의 사자가 또 그에게 이르되 네가 임신하였은즉 아들을 낳으리니 그 이름을 이스마엘이라 하라 이는 여호와께서 네 고통을 들으셨음이니라</br>
<br>12 그가 사람 중에 들나귀 같이 되리니 그의 손이 모든 사람을 치겠고 모든 사람의 손이 그를 칠지며 그가 모든 형제와 대항해서 살리라 하니라</br>
<br>13 하갈이 자기에게 이르신 여호와의 이름을 나를 살피시는 하나님이라 하였으니 이는 내가 어떻게 여기서 나를 살피시는 하나님을 뵈었는고 함이라</br>
<br>14 이러므로 그 샘을 브엘라해로이라 불렀으며 그것은 가데스와 베렛 사이에 있더라</br>
<br>15 하갈이 아브람의 아들을 낳으매 아브람이 하갈이 낳은 그 아들을 이름하여 이스마엘이라 하였더라</br>
<br>16 하갈이 아브람에게 이스마엘을 낳았을 때에 아브람이 팔십육 세였더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 17 장</font></br></strong>
<br><i><font color="#808080">*할례:언약의 표징*</font></i></br>
<br>1 아브람이 구십구 세 때에 여호와께서 아브람에게 나타나서 그에게 이르시되 나는 전능한 하나님이라 너는 내 앞에서 행하여 완전하라</br>
<br>2 내가 내 언약을 나와 너 사이에 두어 너를 크게 번성하게 하리라 하시니</br>
<br>3 아브람이 엎드렸더니 하나님이 또 그에게 말씀하여 이르시되</br>
<br>4 보라 내 언약이 너와 함께 있으니 너는 여러 민족의 아버지가 될지라</br>
<br>5 이제 후로는 네 이름을 아브람이라 하지 아니하고 아브라함이라 하리니 이는 내가 너를 여러 민족의 아버지가 되게 함이니라</br>
<br>6 내가 너로 심히 번성하게 하리니 내가 네게서 민족들이 나게 하며 왕들이 네게로부터 나오리라</br>
<br>7 내가 내 언약을 나와 너 및 네 대대 후손 사이에 세워서 영원한 언약을 삼고 너와 네 후손의 하나님이 되리라</br>
<br>8 내가 너와 네 후손에게 네가 거류하는 이 땅 곧 가나안 온 땅을 주어 영원한 기업이 되게 하고 나는 그들의 하나님이 되리라</br>
<br>9 하나님이 또 아브라함에게 이르시되 그런즉 너는 내 언약을 지키고 네 후손도 대대로 지키라</br>
<br>10 너희 중 남자는 다 할례를 받으라 이것이 나와 너희와 너희 후손 사이에 지킬 내 언약이니라</br>
<br>11 너희는 포피를 베어라 이것이 나와 너희 사이의 언약의 표징이니라</br>
<br>12 너희의 대대로 모든 남자는 집에서 난 자나 또는 너희 자손이 아니라 이방 사람에게서 돈으로 산 자를 막론하고 난 지 팔 일 만에 할례를 받을 것이라</br>
<br>13 너희 집에서 난 자든지 너희 돈으로 산 자든지 할례를 받아야 하리니 이에 내 언약이 너희 살에 있어 영원한 언약이 되려니와</br>
<br>14 할례를 받지 아니한 남자 곧 그 포피를 베지 아니한 자는 백성 중에서 끊어지리니 그가 내 언약을 배반하였음이니라</br>
<br>15 하나님이 또 아브라함에게 이르시되 네 아내 사래는 이름을 사래라 하지 말고 사라라 하라</br>
<br>16 내가 그에게 복을 주어 그가 네게 아들을 낳아 주게 하며 내가 그에게 복을 주어 그를 여러 민족의 어머니가 되게 하리니 민족의 여러 왕이 그에게서 나리라</br>
<br>17 아브라함이 엎드려 웃으며 마음속으로 이르되 백 세 된 사람이 어찌 자식을 낳을까 사라는 구십 세니 어찌 출산하리요 하고</br>
<br>18 아브라함이 이에 하나님께 아뢰되 이스마엘이나 하나님 앞에 살기를 원하나이다</br>
<br>19 하나님이 이르시되 아니라 네 아내 사라가 네게 아들을 낳으리니 너는 그 이름을 이삭이라 하라 내가 그와 내 언약을 세우리니 그의 후손에게 영원한 언약이 되리라</br>
<br>20 이스마엘에 대하여는 내가 네 말을 들었나니 내가 그에게 복을 주어 그를 매우 크게 생육하고 번성하게 할지라 그가 열두 두령을 낳으리니 내가 그를 큰 나라가 되게 하려니와</br>
<br>21 내 언약은 내가 내년 이 시기에 사라가 네게 낳을 이삭과 세우리라</br>
<br>22 하나님이 아브라함과 말씀을 마치시고 그를 떠나 올라가셨더라</br>
<br>23 이에 아브라함이 하나님이 자기에게 말씀하신 대로 이 날에 그 아들 이스마엘과 집에서 태어난 모든 자와 돈으로 산 모든 자 곧 아브라함의 집 사람 중 모든 남자를 데려다가 그 포피를 베었으니</br>
<br>24 아브라함이 그의 포피를 벤 때는 구십구 세였고</br>
<br>25 그의 아들 이스마엘이 그의 포피를 벤 때는 십삼 세였더라</br>
<br>26 그 날에 아브라함과 그 아들 이스마엘이 할례를 받았고</br>
<br>27 그 집의 모든 남자 곧 집에서 태어난 자와 돈으로 이방 사람에게서 사온 자가 다 그와 함께 할례를 받았더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 18 장</font></br></strong>
<br><i><font color="#808080">*아브라함이 아들을 약속받다*</font></i></br>
<br>1 여호와께서 마므레의 상수리나무들이 있는 곳에서 아브라함에게 나타나시니라 날이 뜨거울 때에 그가 장막 문에 앉아 있다가</br>
<br>2 눈을 들어 본즉 사람 셋이 맞은편에 서 있는지라 그가 그들을 보자 곧 장막 문에서 달려나가 영접하며 몸을 땅에 굽혀</br>
<br>3 이르되 내 주여 내가 주께 은혜를 입었사오면 원하건대 종을 떠나 지나가지 마시옵고</br>
<br>4 물을 조금 가져오게 하사 당신들의 발을 씻으시고 나무 아래에서 쉬소서</br>
<br>5 내가 떡을 조금 가져오리니 당신들의 마음을 상쾌하게 하신 후에 지나가소서 당신들이 종에게 오셨음이니이다 그들이 이르되 네 말대로 그리하라</br>
<br>6 아브라함이 급히 장막으로 가서 사라에게 이르되 속히 고운 가루 세 스아를 가져다가 반죽하여 떡을 만들라 하고</br>
<br>7 아브라함이 또 가축 떼 있는 곳으로 달려가서 기름지고 좋은 송아지를 잡아 하인에게 주니 그가 급히 요리한지라</br>
<br>8 아브라함이 엉긴 젖과 우유와 하인이 요리한 송아지를 가져다가 그들 앞에 차려 놓고 나무 아래에 모셔 서매 그들이 먹으니라</br>
<br>9 그들이 아브라함에게 이르되 네 아내 사라가 어디 있느냐 대답하되 장막에 있나이다</br>
<br>10 그가 이르시되 내년 이맘때 내가 반드시 네게로 돌아오리니 네 아내 사라에게 아들이 있으리라 하시니 사라가 그 뒤 장막 문에서 들었더라</br>
<br>11 아브라함과 사라는 나이가 많아 늙었고 사라에게는 여성의 생리가 끊어졌는지라</br>
<br>12 사라가 속으로 웃고 이르되 내가 노쇠하였고 내 주인도 늙었으니 내게 무슨 즐거움이 있으리요</br>
<br>13 여호와께서 아브라함에게 이르시되 사라가 왜 웃으며 이르기를 내가 늙었거늘 어떻게 아들을 낳으리요 하느냐</br>
<br>14 여호와께 능하지 못한 일이 있겠느냐 기한이 이를 때에 내가 네게로 돌아오리니 사라에게 아들이 있으리라</br>
<br>15 사라가 두려워서 부인하여 이르되 내가 웃지 아니하였나이다 이르시되 아니라 네가 웃었느니라</br>
<br><i><font color="#808080">*아브라함이 소돔을 위하여 빌다*</font></i></br>
<br>16 그 사람들이 거기서 일어나서 소돔으로 향하고 아브라함은 그들을 전송하러 함께 나가니라</br>
<br>17 여호와께서 이르시되 내가 하려는 것을 아브라함에게 숨기겠느냐</br>
<br>18 아브라함은 강대한 나라가 되고 천하 만민은 그로 말미암아 복을 받게 될 것이 아니냐</br>
<br>19 내가 그로 그 자식과 권속에게 명하여 여호와의 도를 지켜 의와 공도를 행하게 하려고 그를 택하였나니 이는 나 여호와가 아브라함에게 대하여 말한 일을 이루려 함이니라</br>
<br>20 여호와께서 또 이르시되 소돔과 고모라에 대한 부르짖음이 크고 그 죄악이 심히 무거우니</br>
<br>21 내가 이제 내려가서 그 모든 행한 것이 과연 내게 들린 부르짖음과 같은지 그렇지 않은지 내가 보고 알려 하노라</br>
<br>22 그 사람들이 거기서 떠나 소돔으로 향하여 가고 아브라함은 여호와 앞에 그대로 섰더니</br>
<br>23 아브라함이 가까이 나아가 이르되 주께서 의인을 악인과 함께 멸하려 하시나이까</br>
<br>24 그 성 중에 의인 오십 명이 있을지라도 주께서 그 곳을 멸하시고 그 오십 의인을 위하여 용서하지 아니하시리이까</br>
<br>25 주께서 이같이 하사 의인을 악인과 함께 죽이심은 부당하오며 의인과 악인을 같이 하심도 부당하니이다 세상을 심판하시는 이가 정의를 행하실 것이 아니니이까</br>
<br>26 여호와께서 이르시되 내가 만일 소돔 성읍 가운데에서 의인 오십 명을 찾으면 그들을 위하여 온 지역을 용서하리라</br>
<br>27 아브라함이 대답하여 이르되 나는 티끌이나 재와 같사오나 감히 주께 아뢰나이다</br>
<br>28 오십 의인 중에 오 명이 부족하다면 그 오 명이 부족함으로 말미암아 온 성읍을 멸하시리이까 이르시되 내가 거기서 사십오 명을 찾으면 멸하지 아니하리라</br>
<br>29 아브라함이 또 아뢰어 이르되 거기서 사십 명을 찾으시면 어찌 하려 하시나이까 이르시되 사십 명으로 말미암아 멸하지 아니하리라</br>
<br>30 아브라함이 이르되 내 주여 노하지 마시옵고 말씀하게 하옵소서 거기서 삼십 명을 찾으시면 어찌 하려 하시나이까 이르시되 내가 거기서 삼십 명을 찾으면 그리하지 아니하리라</br>
<br>31 아브라함이 또 이르되 내가 감히 내 주께 아뢰나이다 거기서 이십 명을 찾으시면 어찌 하려 하시나이까 이르시되 내가 이십 명으로 말미암아 그리하지 아니하리라</br>
<br>32 아브라함이 또 이르되 주는 노하지 마옵소서 내가 이번만 더 아뢰리이다 거기서 십 명을 찾으시면 어찌 하려 하시나이까 이르시되 내가 십 명으로 말미암아 멸하지 아니하리라</br>
<br>33 여호와께서 아브라함과 말씀을 마치시고 가시니 아브라함도 자기 곳으로 돌아갔더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 19 장</font></br></strong>
<br><i><font color="#808080">*소돔의 죄악*</font></i></br>
<br>1 저녁 때에 그 두 천사가 소돔에 이르니 마침 롯이 소돔 성문에 앉아 있다가 그들을 보고 일어나 영접하고 땅에 엎드려 절하며</br>
<br>2 이르되 내 주여 돌이켜 종의 집으로 들어와 발을 씻고 주무시고 일찍이 일어나 갈 길을 가소서 그들이 이르되 아니라 우리가 거리에서 밤을 새우리라</br>
<br>3 롯이 간청하매 그제서야 돌이켜 그 집으로 들어오는지라 롯이 그들을 위하여 식탁을 베풀고 무교병을 구우니 그들이 먹으니라</br>
<br>4 그들이 눕기 전에 그 성 사람 곧 소돔 백성들이 노소를 막론하고 원근에서 다 모여 그 집을 에워싸고</br>
<br>5 롯을 부르고 그에게 이르되 오늘 밤에 네게 온 사람들이 어디 있느냐 이끌어 내라 우리가 그들을 상관하리라</br>
<br>6 롯이 문 밖의 무리에게로 나가서 뒤로 문을 닫고</br>
<br>7 이르되 청하노니 내 형제들아 이런 악을 행하지 말라</br>
<br>8 내게 남자를 가까이 하지 아니한 두 딸이 있노라 청하건대 내가 그들을 너희에게로 이끌어 내리니 너희 눈에 좋을 대로 그들에게 행하고 이 사람들은 내 집에 들어왔은즉 이 사람들에게는 아무 일도 저지르지 말라</br>
<br>9 그들이 이르되 너는 물러나라 또 이르되 이 자가 들어와서 거류하면서 우리의 법관이 되려 하는도다 이제 우리가 그들보다 너를 더 해하리라 하고 롯을 밀치며 가까이 가서 그 문을 부수려고 하는지라</br>
<br>10 그 사람들이 손을 내밀어 롯을 집으로 끌어들이고 문을 닫고</br>
<br>11 문 밖의 무리를 대소를 막론하고 그 눈을 어둡게 하니 그들이 문을 찾느라고 헤매었더라</br>
<br><i><font color="#808080">*롯이 소돔을 떠나다*</font></i></br>
<br>12 그 사람들이 롯에게 이르되 이 외에 네게 속한 자가 또 있느냐 네 사위나 자녀나 성 중에 네게 속한 자들을 다 성 밖으로 이끌어 내라</br>
<br>13 그들에 대한 부르짖음이 여호와 앞에 크므로 여호와께서 이 곳을 멸하시려고 우리를 보내셨나니 우리가 멸하리라</br>
<br>14 롯이 나가서 그 딸들과 결혼할 사위들에게 말하여 이르기를 여호와께서 이 성을 멸하실 터이니 너희는 일어나 이 곳에서 떠나라 하되 그의 사위들은 농담으로 여겼더라</br>
<br>15 동틀 때에 천사가 롯을 재촉하여 이르되 일어나 여기 있는 네 아내와 두 딸을 이끌어 내라 이 성의 죄악 중에 함께 멸망할까 하노라</br>
<br>16 그러나 롯이 지체하매 그 사람들이 롯의 손과 그 아내의 손과 두 딸의 손을 잡아 인도하여 성 밖에 두니 여호와께서 그에게 자비를 더하심이었더라</br>
<br>17 그 사람들이 그들을 밖으로 이끌어 낸 후에 이르되 도망하여 생명을 보존하라 돌아보거나 들에 머물지 말고 산으로 도망하여 멸망함을 면하라</br>
<br>18 롯이 그들에게 이르되 내 주여 그리 마옵소서</br>
<br>19 주의 종이 주께 은혜를 입었고 주께서 큰 인자를 내게 베푸사 내 생명을 구원하시오나 내가 도망하여 산에까지 갈 수 없나이다 두렵건대 재앙을 만나 죽을까 하나이다</br>
<br>20 보소서 저 성읍은 도망하기에 가깝고 작기도 하오니 나를 그 곳으로 도망하게 하소서 이는 작은 성읍이 아니니이까 내 생명이 보존되리이다</br>
<br>21 그가 그에게 이르되 내가 이 일에도 네 소원을 들었은즉 네가 말하는 그 성읍을 멸하지 아니하리니</br>
<br>22 그리로 속히 도망하라 네가 거기 이르기까지는 내가 아무 일도 행할 수 없노라 하였더라 그러므로 그 성읍 이름을 소알이라 불렀더라</br>
<br><i><font color="#808080">*소돔과 고모라를 멸하시다*</font></i></br>
<br>23 롯이 소알에 들어갈 때에 해가 돋았더라</br>
<br>24 여호와께서 하늘 곧 여호와께로부터 유황과 불을 소돔과 고모라에 비같이 내리사</br>
<br>25 그 성들과 온 들과 성에 거주하는 모든 백성과 땅에 난 것을 다 엎어 멸하셨더라</br>
<br>26 롯의 아내는 뒤를 돌아보았으므로 소금 기둥이 되었더라</br>
<br>27 아브라함이 그 아침에 일찍이 일어나 여호와 앞에 서 있던 곳에 이르러</br>
<br>28 소돔과 고모라와 그 온 지역을 향하여 눈을 들어 연기가 옹기 가마의 연기같이 치솟음을 보았더라</br>
<br>29 하나님이 그 지역의 성을 멸하실 때 곧 롯이 거주하는 성을 엎으실 때에 하나님이 아브라함을 생각하사 롯을 그 엎으시는 중에서 내보내셨더라</br>
<br><i><font color="#808080">*모압과 암몬 자손의 조상*</font></i></br>
<br>30 롯이 소알에 거주하기를 두려워하여 두 딸과 함께 소알에서 나와 산에 올라가 거주하되 그 두 딸과 함께 굴에 거주하였더니</br>
<br>31 큰 딸이 작은 딸에게 이르되 우리 아버지는 늙으셨고 온 세상의 도리를 따라 우리의 배필 될 사람이 이 땅에는 없으니</br>
<br>32 우리가 우리 아버지에게 술을 마시게 하고 동침하여 우리 아버지로 말미암아 후손을 이어가자 하고</br>
<br>33 그 밤에 그들이 아버지에게 술을 마시게 하고 큰 딸이 들어가서 그 아버지와 동침하니라 그러나 그 아버지는 그 딸이 눕고 일어나는 것을 깨닫지 못하였더라</br>
<br>34 이튿날 큰 딸이 작은 딸에게 이르되 어제 밤에는 내가 우리 아버지와 동침하였으니 오늘 밤에도 우리가 아버지에게 술을 마시게 하고 네가 들어가 동침하고 우리가 아버지로 말미암아 후손을 이어가자 하고</br>
<br>35 그 밤에도 그들이 아버지에게 술을 마시게 하고 작은 딸이 일어나 아버지와 동침하니라 그러나 아버지는 그 딸이 눕고 일어나는 것을 깨닫지 못하였더라</br>
<br>36 롯의 두 딸이 아버지로 말미암아 임신하고</br>
<br>37 큰 딸은 아들을 낳아 이름을 모압이라 하였으니 오늘날 모압의 조상이요</br>
<br>38 작은 딸도 아들을 낳아 이름을 벤암미라 하였으니 오늘날 암몬 자손의 조상이었더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 20 장</font></br></strong>
<br><i><font color="#808080">*아브라함과 아비멜렉*</font></i></br>
<br>1 아브라함이 거기서 네게브 땅으로 옮겨가 가데스와 술 사이 그랄에 거류하며</br>
<br>2 그의 아내 사라를 자기 누이라 하였으므로 그랄 왕 아비멜렉이 사람을 보내어 사라를 데려갔더니</br>
<br>3 그 밤에 하나님이 아비멜렉에게 현몽하시고 그에게 이르시되 네가 데려간 이 여인으로 말미암아 네가 죽으리니 그는 남편이 있는 여자임이라</br>
<br>4 아비멜렉이 그 여인을 가까이 하지 아니하였으므로 그가 대답하되 주여 주께서 의로운 백성도 멸하시나이까</br>
<br>5 그가 나에게 이는 내 누이라고 하지 아니하였나이까 그 여인도 그는 내 오라비라 하였사오니 나는 온전한 마음과 깨끗한 손으로 이렇게 하였나이다</br>
<br>6 하나님이 꿈에 또 그에게 이르시되 네가 온전한 마음으로 이렇게 한 줄을 나도 알았으므로 너를 막아 내게 범죄하지 아니하게 하였나니 여인에게 가까이 하지 못하게 함이 이 때문이니라</br>
<br>7 이제 그 사람의 아내를 돌려보내라 그는 선지자라 그가 너를 위하여 기도하리니 네가 살려니와 네가 돌려보내지 아니하면 너와 네게 속한 자가 다 반드시 죽을 줄 알지니라</br>
<br>8 아비멜렉이 그 날 아침에 일찍이 일어나 모든 종들을 불러 그 모든 일을 말하여 들려 주니 그들이 심히 두려워하였더라</br>
<br>9 아비멜렉이 아브라함을 불러서 그에게 이르되 네가 어찌하여 우리에게 이렇게 하느냐 내가 무슨 죄를 네게 범하였기에 네가 나와 내 나라가 큰 죄에 빠질 뻔하게 하였느냐 네가 합당하지 아니한 일을 내게 행하였도다 하고</br>
<br>10 아비멜렉이 또 아브라함에게 이르되 네가 무슨 뜻으로 이렇게 하였느냐</br>
<br>11 아브라함이 이르되 이 곳에서는 하나님을 두려워함이 없으니 내 아내로 말미암아 사람들이 나를 죽일까 생각하였음이요</br>
<br>12 또 그는 정말로 나의 이복 누이로서 내 아내가 되었음이니라</br>
<br>13 하나님이 나를 내 아버지의 집을 떠나 두루 다니게 하실 때에 내가 아내에게 말하기를 이 후로 우리의 가는 곳마다 그대는 나를 그대의 오라비라 하라 이것이 그대가 내게 베풀 은혜라 하였었노라</br>
<br>14 아비멜렉이 양과 소와 종들을 이끌어 아브라함에게 주고 그의 아내 사라도 그에게 돌려보내고</br>
<br>15 아브라함에게 이르되 내 땅이 네 앞에 있으니 네가 보기에 좋은 대로 거주하라 하고</br>
<br>16 사라에게 이르되 내가 은 천 개를 네 오라비에게 주어서 그것으로 너와 함께 한 여러 사람 앞에서 네 수치를 가리게 하였노니 네 일이 다 해결되었느니라</br>
<br>17 아브라함이 하나님께 기도하매 하나님이 아비멜렉과 그의 아내와 여종을 치료하사 출산하게 하셨으니</br>
<br>18 여호와께서 이왕에 아브라함의 아내 사라의 일로 아비멜렉의 집의 모든 태를 닫으셨음이더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 21 장</font></br></strong>
<br><i><font color="#808080">*사라가 이삭을 낳다*</font></i></br>
<br>1 여호와께서 말씀하신 대로 사라를 돌보셨고 여호와께서 말씀하신 대로 사라에게 행하셨으므로</br>
<br>2 사라가 임신하고 하나님이 말씀하신 시기가 되어 노년의 아브라함에게 아들을 낳으니</br>
<br>3 아브라함이 그에게 태어난 아들 곧 사라가 자기에게 낳은 아들을 이름하여 이삭이라 하였고</br>
<br>4 그 아들 이삭이 난 지 팔 일 만에 그가 하나님이 명령하신 대로 할례를 행하였더라</br>
<br>5 아브라함이 그의 아들 이삭이 그에게 태어날 때에 백 세라</br>
<br>6 사라가 이르되 하나님이 나를 웃게 하시니 듣는 자가 다 나와 함께 웃으리로다</br>
<br>7 또 이르되 사라가 자식들을 젖먹이겠다고 누가 아브라함에게 말하였으리요마는 아브라함의 노경에 내가 아들을 낳았도다 하니라</br>
<br><i><font color="#808080">*하갈과 이스마엘을 내쫓다*</font></i></br>
<br>8 아이가 자라매 젖을 떼고 이삭이 젖을 떼는 날에 아브라함이 큰 잔치를 베풀었더라</br>
<br>9 사라가 본즉 아브라함의 아들 애굽 여인 하갈의 아들이 이삭을 놀리는지라</br>
<br>10 그가 아브라함에게 이르되 이 여종과 그 아들을 내쫓으라 이 종의 아들은 내 아들 이삭과 함께 기업을 얻지 못하리라 하므로</br>
<br>11 아브라함이 그의 아들로 말미암아 그 일이 매우 근심이 되었더니</br>
<br>12 하나님이 아브라함에게 이르시되 네 아이나 네 여종으로 말미암아 근심하지 말고 사라가 네게 이른 말을 다 들으라 이삭에게서 나는 자라야 네 씨라 부를 것임이니라</br>
<br>13 그러나 여종의 아들도 네 씨니 내가 그로 한 민족을 이루게 하리라 하신지라</br>
<br>14 아브라함이 아침에 일찍이 일어나 떡과 물 한 가죽부대를 가져다가 하갈의 어깨에 메워 주고 그 아이를 데리고 가게 하니 하갈이 나가서 브엘세바 광야에서 방황하더니</br>
<br>15 가죽부대의 물이 떨어진지라 그 자식을 관목덤불 아래에 두고</br>
<br>16 이르되 아이가 죽는 것을 차마 보지 못하겠다 하고 화살 한 바탕 거리 떨어져 마주 앉아 바라보며 소리 내어 우니</br>
<br>17 하나님이 그 어린 아이의 소리를 들으셨으므로 하나님의 사자가 하늘에서부터 하갈을 불러 이르시되 하갈아 무슨 일이냐 두려워하지 말라 하나님이 저기 있는 아이의 소리를 들으셨나니</br>
<br>18 일어나 아이를 일으켜 네 손으로 붙들라 그가 큰 민족을 이루게 하리라 하시니라</br>
<br>19 하나님이 하갈의 눈을 밝히셨으므로 샘물을 보고 가서 가죽부대에 물을 채워다가 그 아이에게 마시게 하였더라</br>
<br>20 하나님이 그 아이와 함께 계시매 그가 장성하여 광야에서 거주하며 활 쏘는 자가 되었더니</br>
<br>21 그가 바란 광야에 거주할 때에 그의 어머니가 그를 위하여 애굽 땅에서 아내를 얻어 주었더라</br>
<br><i><font color="#808080">*아브라함과 아비멜렉의 언약*</font></i></br>
<br>22 그 때에 아비멜렉과 그 군대 장관 비골이 아브라함에게 말하여 이르되 네가 무슨 일을 하든지 하나님이 너와 함께 계시도다</br>
<br>23 그런즉 너는 나와 내 아들과 내 손자에게 거짓되이 행하지 아니하기를 이제 여기서 하나님을 가리켜 내게 맹세하라 내가 네게 후대한 대로 너도 나와 네가 머무는 이 땅에 행할 것이니라</br>
<br>24 아브라함이 이르되 내가 맹세하리라 하고</br>
<br>25 아비멜렉의 종들이 아브라함의 우물을 빼앗은 일에 관하여 아브라함이 아비멜렉을 책망하매</br>
<br>26 아비멜렉이 이르되 누가 그리하였는지 내가 알지 못하노라 너도 내게 알리지 아니하였고 나도 듣지 못하였더니 오늘에야 들었노라</br>
<br>27 아브라함이 양과 소를 가져다가 아비멜렉에게 주고 두 사람이 서로 언약을 세우니라</br>
<br>28 아브라함이 일곱 암양 새끼를 따로 놓으니</br>
<br>29 아비멜렉이 아브라함에게 이르되 이 일곱 암양 새끼를 따로 놓음은 어찜이냐</br>
<br>30 아브라함이 이르되 너는 내 손에서 이 암양 새끼 일곱을 받아 내가 이 우물 판 증거를 삼으라 하고</br>
<br>31 두 사람이 거기서 서로 맹세하였으므로 그 곳을 브엘세바라 이름하였더라</br>
<br>32 그들이 브엘세바에서 언약을 세우매 아비멜렉과 그 군대 장관 비골은 떠나 블레셋 사람의 땅으로 돌아갔고</br>
<br>33 아브라함은 브엘세바에 에셀 나무를 심고 거기서 영원하신 여호와의 이름을 불렀으며</br>
<br>34 그가 블레셋 사람의 땅에서 여러 날을 지냈더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 22 장</font></br></strong>
<br><i><font color="#808080">*이삭을 번제로 드리라 하시다*</font></i></br>
<br>1 그 일 후에 하나님이 아브라함을 시험하시려고 그를 부르시되 아브라함아 하시니 그가 이르되 내가 여기 있나이다</br>
<br>2 여호와께서 이르시되 네 아들 네 사랑하는 독자 이삭을 데리고 모리아 땅으로 가서 내가 네게 일러 준 한 산 거기서 그를 번제로 드리라</br>
<br>3 아브라함이 아침에 일찍이 일어나 나귀에 안장을 지우고 두 종과 그의 아들 이삭을 데리고 번제에 쓸 나무를 쪼개어 가지고 떠나 하나님이 자기에게 일러 주신 곳으로 가더니</br>
<br>4 제삼일에 아브라함이 눈을 들어 그 곳을 멀리 바라본지라</br>
<br>5 이에 아브라함이 종들에게 이르되 너희는 나귀와 함께 여기서 기다리라 내가 아이와 함께 저기 가서 예배하고 우리가 너희에게로 돌아오리라 하고</br>
<br>6 아브라함이 이에 번제 나무를 가져다가 그의 아들 이삭에게 지우고 자기는 불과 칼을 손에 들고 두 사람이 동행하더니</br>
<br>7 이삭이 그 아버지 아브라함에게 말하여 이르되 내 아버지여 하니 그가 이르되 내 아들아 내가 여기 있노라 이삭이 이르되 불과 나무는 있거니와 번제할 어린 양은 어디 있나이까</br>
<br>8 아브라함이 이르되 내 아들아 번제할 어린 양은 하나님이 자기를 위하여 친히 준비하시리라 하고 두 사람이 함께 나아가서</br>
<br>9 하나님이 그에게 일러 주신 곳에 이른지라 이에 아브라함이 그 곳에 제단을 쌓고 나무를 벌여 놓고 그의 아들 이삭을 결박하여 제단 나무 위에 놓고</br>
<br>10 손을 내밀어 칼을 잡고 그 아들을 잡으려 하니</br>
<br>11 여호와의 사자가 하늘에서부터 그를 불러 이르시되 아브라함아 아브라함아 하시는지라 아브라함이 이르되 내가 여기 있나이다 하매</br>
<br>12 사자가 이르시되 그 아이에게 네 손을 대지 말라 그에게 아무 일도 하지 말라 네가 네 아들 네 독자까지도 내게 아끼지 아니하였으니 내가 이제야 네가 하나님을 경외하는 줄을 아노라</br>
<br>13 아브라함이 눈을 들어 살펴본즉 한 숫양이 뒤에 있는데 뿔이 수풀에 걸려 있는지라 아브라함이 가서 그 숫양을 가져다가 아들을 대신하여 번제로 드렸더라</br>
<br>14 아브라함이 그 땅 이름을 여호와 이레라 하였으므로 오늘날까지 사람들이 이르기를 여호와의 산에서 준비되리라 하더라</br>
<br>15 여호와의 사자가 하늘에서부터 두 번째 아브라함을 불러</br>
<br>16 이르시되 여호와께서 이르시기를 내가 나를 가리켜 맹세하노니 네가 이같이 행하여 네 아들 네 독자도 아끼지 아니하였은즉</br>
<br>17 내가 네게 큰 복을 주고 네 씨가 크게 번성하여 하늘의 별과 같고 바닷가의 모래와 같게 하리니 네 씨가 그 대적의 성문을 차지하리라</br>
<br>18 또 네 씨로 말미암아 천하 만민이 복을 받으리니 이는 네가 나의 말을 준행하였음이니라 하셨다 하니라</br>
<br>19 이에 아브라함이 그의 종들에게로 돌아가서 함께 떠나 브엘세바에 이르러 거기 거주하였더라</br>
<br><i><font color="#808080">*나홀의 후예*</font></i></br>
<br>20 이 일 후에 어떤 사람이 아브라함에게 알리어 이르기를 밀가가 당신의 형제 나홀에게 자녀를 낳았다 하였더라</br>
<br>21 그의 맏아들은 우스요 우스의 형제는 부스와 아람의 아버지 그므엘과</br>
<br>22 게셋과 하소와 빌다스와 이들랍과 브두엘이라</br>
<br>23 이 여덟 사람은 아브라함의 형제 나홀의 아내 밀가의 소생이며 브두엘은 리브가를 낳았고</br>
<br>24 나홀의 첩 르우마라 하는 자도 데바와 가함과 다하스와 마아가를 낳았더라</br>
<br>&nbsp;</br>
<strong><br><font color="#4682b4">창세기 23 장</font></br></strong>
<br><i><font color="#808080">*아브라함이 막벨라 굴을 사다*</font></i></br>
<br>1 사라가 백이십칠 세를 살았으니 이것이 곧 사라가 누린 햇수라</br>
<br>2 사라가 가나안 땅 헤브론 곧 기럇아르바에서 죽으매 아브라함이 들어가서 사라를 위하여 슬퍼하며 애통하다가</br>
<br>3 그 시신 앞에서 일어나 나가서 헷 족속에게 말하여 이르되</br>
<br>4 나는 당신들 중에 나그네요 거류하는 자이니 당신들 중에서 내게 매장할 소유지를 주어 내가 나의 죽은 자를 내 앞에서 내어다가 장사하게 하시오</br>
<br>5 헷 족속이 아브라함에게 대답하여 이르되</br>
<br>6 내 주여 들으소서 당신은 우리 가운데 있는 하나님이 세우신 지도자이시니 우리 묘실 중에서 좋은 것을 택하여 당신의 죽은 자를 장사하소서 우리 중에서 자기 묘실에 당신의 죽은 자 장사함을 금할 자가 없으리이다</br>
<br>7 아브라함이 일어나 그 땅 주민 헷 족속을 향하여 몸을 굽히고</br>
<br>8 그들에게 말하여 이르되 나로 나의 죽은 자를 내 앞에서 내어다가 장사하게 하는 일이 당신들의 뜻일진대 내 말을 듣고 나를 위하여 소할의 아들 에브론에게 구하여</br>
<br>9 그가 그의 밭머리에 있는 그의 막벨라 굴을 내게 주도록 하되 충분한 대가를 받고 그 굴을 내게 주어 당신들 중에서 매장할 소유지가 되게 하기를 원하노라 하매</br>
<br>10 에브론이 헷 족속 중에 앉아 있더니 그가 헷 족속 곧 성문에 들어온 모든 자가 듣는 데서 아브라함에게 대답하여 이르되</br>
<br>11 내 주여 그리 마시고 내 말을 들으소서 내가 그 밭을 당신에게 드리고 그 속의 굴도 내가 당신에게 드리되 내가 내 동족 앞에서 당신에게 드리오니 당신의 죽은 자를 장사하소서</br>
<br>12 아브라함이 이에 그 땅의 백성 앞에서 몸을 굽히고</br>
<br>13 그 땅의 백성이 듣는 데서 에브론에게 말하여 이르되 당신이 합당히 여기면 청하건대 내 말을 들으시오 내가 그 밭 값을 당신에게 주리니 당신은 내게서 받으시오 내가 나의 죽은 자를 거기 장사하겠노라</br>
<br>14 에브론이 아브라함에게 대답하여 이르되</br>
<br>15 내 주여 내 말을 들으소서 땅 값은 은 사백 세겔이나 그것이 나와 당신 사이에 무슨 문제가 되리이까 당신의 죽은 자를 장사하소서</br>
<br>16 아브라함이 에브론의 말을 따라 에브론이 헷 족속이 듣는 데서 말한 대로 상인이 통용하는 은 사백 세겔을 달아 에브론에게 주었더니</br>
<br>17 마므레 앞 막벨라에 있는 에브론의 밭 곧 그 밭과 거기에 속한 굴과 그 밭과 그 주위에 둘린 모든 나무가</br>
<br>18 성 문에 들어온 모든 헷 족속이 보는 데서 아브라함의 소유로 확정된지라</br>
<br>19 그 후에 아브라함이 그 아내 사라를 가나안 땅 마므레 앞 막벨라 밭 굴에 장사하였더라 (마므레는 곧 헤브론이라)</br>
<br>20 이와 같이 그 밭과 거기에 속한 굴이 헷 족속으로부터 아브라함이 매장할 소유지로 확정되었더라</br>
<br>&nbsp;</br>
<br>    2일차 끝</br>
<br>&nbsp;</br>
    </h2>
  </div>

  <!-- 모달 (설명/요약 출력) -->
  <div id="explanation-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-content">
      <span class="close-button" id="close-modal" aria-label="닫기">&times;</span>
      <h3 id="modal-title">구절 설명</h3>
      <img id="modal-image" src="" alt="설명 관련 이미지" />
      <div id="modal-text">구절을 드래그하여 선택하고 '구절설명' 버튼을 누르세요.</div>
    </div>
  </div>

  <div id="scroll-marker-container" class="scroll-marker-container" aria-hidden="true"></div>

  <script>
    // ------------------------------
    // API KEY (사용자 입력 상태)
    const apiKey = "AIzaSyDUlSQlSPgnrFBXpnUJMDoUO3s_KsaoFRU";
    // ------------------------------

    // DOM
    const bibleTextEl = document.getElementById('bible-text');
    const searchCountEl = document.getElementById('search-count');
    const nextLocationBtn = document.getElementById('next-location-btn');
    const scrollMarkerContainer = document.getElementById('scroll-marker-container');

    const explanationIconButton = document.getElementById('explanation-icon-button');
    const explanationButtonWrapper = document.getElementById('explanation-button-wrapper');
    const explanationSubButtons = document.getElementById('explanation-sub-buttons');
    const detailedExplanationButton = document.getElementById('detailed-explanation-button');
    const simpleExplanationButton = document.getElementById('simple-explanation-button');

    const summarySimpleMain = document.getElementById('summary-simple-main');
    const summaryDetailedMain = document.getElementById('summary-detailed-main');

    const modal = document.getElementById('explanation-modal');
    const closeModalButton = document.getElementById('close-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalImage = document.getElementById('modal-image');
    const modalText = document.getElementById('modal-text');

    const audio = document.getElementById('audio-file');
    const playBtn = document.getElementById('play-btn');
    const pauseBtn = document.getElementById('pause-btn');
    const stopBtn = document.getElementById('stop-btn');
    const progressBar = document.getElementById('progress-bar');
    const rewindBtn = document.getElementById('rewind-10');
    const forwardBtn = document.getElementById('forward-10');
    const speedDisplay = document.getElementById('speed-display');
    const speedDown02Btn = document.getElementById('speed-down-02');
    const speedDown01Btn = document.getElementById('speed-down-01');
    const speedUp01Btn = document.getElementById('speed-up-01');
    const speedUp02Btn = document.getElementById('speed-up-02');
    const speedResetBtn = document.getElementById('speed-reset');
    const volumeSlider = document.getElementById('volume-slider');
    const muteBtn = document.getElementById('mute-btn');
    const currentTimeEl = document.getElementById('current-time');
    const remainingTimeEl = document.getElementById('remaining-time');

    const upBtn = document.getElementById('up');
    const downBtn = document.getElementById('down');
    const fontSizeEl = document.getElementById('font-size');

    // 상태
    let originalText = "";
    let selectedVerse = "";
    let selectionRange = null; // 선택 영역 복원용
    let foundSentences = [];
    let currentSearchIndex = -1;
    let currentSpeed = 1.0;
    let isMuted = false;
    let selectionDebounce = null;

    // 유틸
    function escapeRegExp(s) { return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }
    function formatTime(sec) { if (!isFinite(sec) || sec < 0) return '0:00'; const m = Math.floor(sec/60); const s = Math.floor(sec%60); return `${m}:${String(s).padStart(2,'0')}`; }

    // 초기화
    window.addEventListener('DOMContentLoaded', () => {
      originalText = bibleTextEl.innerHTML; // 원본 보관
      updateFontSizeDisplay();
      updateSpeed();

      // 폰트 버튼
      upBtn.addEventListener('click', () => {
        const current = parseFloat(getComputedStyle(bibleTextEl).fontSize);
        if (current + 4 <= 80) { bibleTextEl.style.fontSize = (current + 4) + 'px'; updateFontSizeDisplay(); }
      });
      downBtn.addEventListener('click', () => {
        const current = parseFloat(getComputedStyle(bibleTextEl).fontSize);
        if (current - 4 >= 12) { bibleTextEl.style.fontSize = (current - 4) + 'px'; updateFontSizeDisplay(); }
      });

      // 검색 폼
      const searchForm = document.forms.f1;
      searchForm.addEventListener('submit', (e) => { e.preventDefault(); findString(searchForm.t1.value); });
      searchForm.b2.addEventListener('click', () => { clearHighlight(); });

      // nextLocation
      nextLocationBtn.addEventListener('click', nextLocation);

      // 오디오
      playBtn.addEventListener('click', () => { audio.play().catch(()=>{}); });
      pauseBtn.addEventListener('click', () => audio.pause());
      stopBtn.addEventListener('click', () => { audio.pause(); audio.currentTime = 0; });

      speedDown02Btn.addEventListener('click', () => { currentSpeed = Math.max(0.5, currentSpeed - 0.2); updateSpeed(); });
      speedDown01Btn.addEventListener('click', () => { currentSpeed = Math.max(0.5, currentSpeed - 0.1); updateSpeed(); });
      speedUp01Btn.addEventListener('click', () => { currentSpeed = Math.min(2.0, currentSpeed + 0.1); updateSpeed(); });
      speedUp02Btn.addEventListener('click', () => { currentSpeed = Math.min(2.0, currentSpeed + 0.2); updateSpeed(); });
      speedResetBtn.addEventListener('click', () => { currentSpeed = 1.0; updateSpeed(); });

      volumeSlider.addEventListener('input', () => { audio.volume = Number(volumeSlider.value); });
      muteBtn.addEventListener('click', () => { isMuted = !isMuted; audio.muted = isMuted; muteBtn.textContent = isMuted ? '🔇' : '🔊'; });

      // progress bar updates
      audio.addEventListener('timeupdate', () => {
        if (!isFinite(audio.duration) || audio.duration <= 0) return;
        const pct = (audio.currentTime / audio.duration) * 100;
        progressBar.value = pct;
        currentTimeEl.textContent = formatTime(audio.currentTime);
        remainingTimeEl.textContent = '-' + formatTime(audio.duration - audio.currentTime);
      }, { passive: true });

      audio.addEventListener('loadedmetadata', () => {
        currentTimeEl.textContent = '0:00';
        remainingTimeEl.textContent = '-' + formatTime(audio.duration || 0);
      });

      progressBar.addEventListener('input', () => {
        if (!isFinite(audio.duration) || audio.duration <= 0) return;
        const pct = progressBar.value / 100;
        audio.currentTime = audio.duration * pct;
      }, { passive: true });

      rewindBtn.addEventListener('click', () => {
        audio.currentTime = Math.max(0, audio.currentTime - 10);
      });

      forwardBtn.addEventListener('click', () => {
        if (isFinite(audio.duration)) {
          audio.currentTime = Math.min(audio.duration, audio.currentTime + 10);
        }
      });

      // 설명 버튼(책) - 클릭시 서브버튼 토글
      // iOS에서 선택이 사라지는 문제를 피하기 위해 클릭/터치 이전 선택영역을 저장하고, 토글 후 복원
      explanationIconButton.addEventListener('pointerdown', (ev) => {
        // pointerdown에서 기본 동작을 방지하면 iOS가 선택을 잃지 않는 경우가 있지만, 안전하게 클론을 저장
        const sel = window.getSelection();
        try {
          if (sel && sel.rangeCount > 0) selectionRange = sel.getRangeAt(0).cloneRange();
        } catch(e) {
          selectionRange = null;
        }
      }, { passive: true });

      explanationIconButton.addEventListener('click', (ev) => {
        ev.stopPropagation();
        // 토글하기 전에 현재 선택을 저장(안전)
        const sel = window.getSelection();
        try { if (sel && sel.rangeCount > 0) selectionRange = sel.getRangeAt(0).cloneRange(); } catch(e){ selectionRange = null; }
        explanationButtonWrapper.classList.toggle('active');

        // 토글 후 약간 뒤에 선택 복원 (iOS에서 클릭으로 인해 사라졌다면 복원)
        setTimeout(() => {
          if (selectionRange) {
            const sel2 = window.getSelection();
            sel2.removeAllRanges();
            try { sel2.addRange(selectionRange); } catch(e){ /* ignore */ }
            // update selectedVerse accordingly
            updateSelectedVerseFromRange(selectionRange);
          }
        }, 60);
      });

      // 책 버튼 외부 클릭으로 닫기
      document.body.addEventListener('click', (ev) => {
        if (!explanationButtonWrapper.contains(ev.target)) explanationButtonWrapper.classList.remove('active');
      });

      // 상세/간단 구절설명 버튼 - 클릭시 선택문구 사용
      detailedExplanationButton.addEventListener('click', () => {
        const v = (selectedVerse || '').trim();
        if (!v) { showModal("구절을 먼저 선택하세요","본문에서 구절이나 단어를 드래그하여 선택한 후 다시 버튼을 눌러주세요."); }
        else { fetchExplanation(v, 'detailed'); }
        explanationButtonWrapper.classList.remove('active');
      });
      simpleExplanationButton.addEventListener('click', () => {
        const v = (selectedVerse || '').trim();
        if (!v) { showModal("구절을 먼저 선택하세요","본문에서 구절이나 단어를 드래그하여 선택한 후 다시 버튼을 눌러주세요."); }
        else { fetchExplanation(v, 'simple'); }
        explanationButtonWrapper.classList.remove('active');
      });

      // 본문 요약 버튼 (항상 보이는 위치)
      summarySimpleMain.addEventListener('click', () => {
        const full = getFullBibleText();
        if (!full.trim()) { showModal("본문이 없습니다","요약할 성경 본문이 없습니다."); }
        else { fetchSummary(full, 'simple'); }
      });
      summaryDetailedMain.addEventListener('click', () => {
        const full = getFullBibleText();
        if (!full.trim()) { showModal("본문이 없습니다","요약할 성경 본문이 없습니다."); }
        else { fetchSummary(full, 'detailed'); }
      });

      // 모달 닫기
      closeModalButton.addEventListener('click', () => { modal.style.display = 'none'; });
      window.addEventListener('click', (ev) => { if (ev.target === modal) modal.style.display = 'none'; });

      // 선택 이벤트: 데스크탑 + 모바일 대응 (디바운스)
      const scheduleSelectionUpdate = () => {
        clearTimeout(selectionDebounce);
        selectionDebounce = setTimeout(handleSelectionChange, 160);
      };
      document.addEventListener('mouseup', scheduleSelectionUpdate, { passive:true });
      document.addEventListener('touchend', scheduleSelectionUpdate, { passive:true });
      document.addEventListener('selectionchange', scheduleSelectionUpdate);

      // 초기 speed 표시
      updateSpeed();
    });

    // --------------------------
    // 선택 관리: iOS에서 선택이 사라지는 문제를 보완
    function handleSelectionChange(){
      const sel = window.getSelection();
      if (!sel) return clearSelectionState();
      const text = (sel.toString() || "").trim();
      // 선택이 본문 내에 있는지 체크
      let isInBible = false;
      try {
        if (sel.anchorNode && sel.focusNode) {
          isInBible = bibleTextEl.contains(sel.anchorNode) && bibleTextEl.contains(sel.focusNode);
        }
      } catch(e){ isInBible = false; }

      if (text && isInBible) {
        selectedVerse = text;
        try {
          selectionRange = sel.getRangeAt(0).cloneRange();
        } catch(e){ selectionRange = null; }
        // 버튼 위치 표시
        try {
          const range = sel.getRangeAt(0);
          const rect = range.getBoundingClientRect();
          positionExplanationButton(rect);
        } catch(e){
          // fallback: 고정 위치
          resetExplanationButton();
        }
      } else {
        clearSelectionState();
      }
    }
    function updateSelectedVerseFromRange(range) {
      if (!range) return;
      const txt = (range.toString() || "").trim();
      if (txt) selectedVerse = txt;
      // position button
      try {
        const rect = range.getBoundingClientRect();
        positionExplanationButton(rect);
      } catch(e){ resetExplanationButton(); }
    }
    function clearSelectionState(){
      selectedVerse = "";
      selectionRange = null;
      resetExplanationButton();
    }

    // 버튼 위치 설정: 화면 밖으로 나가지 않도록 하기
    function positionExplanationButton(rect){
      const container = document.getElementById('explanation-button-container');
      const scrollY = window.scrollY || window.pageYOffset;
      const vh = window.innerHeight;
      const containerHeight = container.offsetHeight || 80;
      // 기본 top 계산
      let topPos = rect.bottom + scrollY + 10;
      // 화면 아래로 넘지 않게
      const maxTop = (window.scrollY || window.pageYOffset) + window.innerHeight - containerHeight - 10;
      topPos = Math.min(topPos, maxTop);
      // 화면 위로 넘지 않게
      const minTop = (window.scrollY || window.pageYOffset) + 10;
      topPos = Math.max(topPos, minTop);
      container.style.position = 'absolute';
      container.style.top = topPos + 'px';

      // 좌우
      const screenCenterX = window.innerWidth / 2;
      if (rect.left < screenCenterX) {
        container.style.left = (rect.right) + 'px';
        container.style.transform = 'translateX(10px)';
      } else {
        container.style.left = rect.left + 'px';
        container.style.transform = 'translateX(-100%) translateX(-10px)';
      }
      container.style.display = 'block';
    }
    function resetExplanationButton(){
      const container = document.getElementById('explanation-button-container');
      container.style.position = 'fixed';
      container.style.left = '30%';
      container.style.top = '100px';
      container.style.transform = 'translateX(-50%)';
      // 노출 유지 (기본 상태)
      //container.style.display = 'block';
    }

    // --------------------------
    // 검색 / 하이라이트 / 스크롤 마커
    function findString(searchText){
      clearHighlight();
      if (searchText == null || searchText.trim() === '') { searchCountEl.textContent = ''; nextLocationBtn.style.display = 'none'; return; }
      const escaped = escapeRegExp(searchText.trim());
      const regex = new RegExp(escaped, 'gi');
      const newContent = originalText.replace(regex, (match) => `<span class="search-highlight">${match}</span>`);
      bibleTextEl.innerHTML = newContent;
      foundSentences = Array.from(bibleTextEl.getElementsByClassName('search-highlight'));
      searchCountEl.textContent = `총 ${foundSentences.length}개 검색됨`;
      if (foundSentences.length > 0) {
        currentSearchIndex = 0;
        foundSentences[currentSearchIndex].scrollIntoView({ behavior:'smooth', block:'center' });
        nextLocationBtn.style.display = 'inline-block';
        updateScrollMarkers();
      } else {
        showModal("검색 결과 없음", `"${searchText}"에 대한 검색 결과가 없습니다.`);
        nextLocationBtn.style.display = 'none';
      }
    }
    function nextLocation(){
      if (!foundSentences.length) return;
      currentSearchIndex = (currentSearchIndex + 1) % foundSentences.length;
      foundSentences[currentSearchIndex].scrollIntoView({ behavior:'smooth', block:'center' });
      // 마커 동기화
      updateScrollMarkers();
    }
    function clearHighlight(){
      bibleTextEl.innerHTML = originalText;
      searchCountEl.textContent = '';
      nextLocationBtn.style.display = 'none';
      while (scrollMarkerContainer.firstChild) scrollMarkerContainer.removeChild(scrollMarkerContainer.firstChild);
      foundSentences = [];
      currentSearchIndex = -1;
    }
    function updateScrollMarkers(){
      while (scrollMarkerContainer.firstChild) scrollMarkerContainer.removeChild(scrollMarkerContainer.firstChild);
      const docH = document.documentElement.scrollHeight;
      const vh = window.innerHeight;
      foundSentences.forEach((el, idx) => {
        const marker = document.createElement('div');
        marker.className = 'scroll-marker';
        const topPos = el.getBoundingClientRect().top + window.scrollY;
        const markerPos = Math.min(Math.max((topPos / docH) * vh, 2), vh - 10);
        marker.style.top = markerPos + 'px';
        marker.addEventListener('click', () => { el.scrollIntoView({ behavior:'smooth', block:'center' }); });
        scrollMarkerContainer.appendChild(marker);
      });
    }

    // --------------------------
    // 모달
    function showModal(title, text, imageUrl=null){
      modalTitle.textContent = title || '';
      modalText.innerHTML = (text || '').toString().replace(/\n/g, '<br>');
      if (imageUrl) { modalImage.src = imageUrl; modalImage.style.display = 'block'; } else { modalImage.src=''; modalImage.style.display='none'; }
      modal.style.display = 'block';
      // 선택영역 유지: 모달 열려도 선택 유지하도록 약간의 복원 시도
      setTimeout(() => {
        if (selectionRange) {
          const sel = window.getSelection();
          sel.removeAllRanges();
          try { sel.addRange(selectionRange); } catch(e) { /* ignore */ }
        }
      }, 60);
    }
    function showLoadingModal(isImage=false){
      modalTitle.innerHTML = `<span class="loader"></span> ${isImage ? '그림 생성 중...' : '설명 생성 중...'}`;
      modalText.textContent = '설명을 생성 중입니다. 잠시만 기다려 주세요...';
      modalImage.style.display = 'none';
      modal.style.display = 'block';
    }

    // --------------------------
    // 본문 전체 텍스트 획득 (요약용)
    function getFullBibleText(){
      const tmp = document.createElement('div');
      tmp.innerHTML = originalText;
      return tmp.textContent.replace(/\s+/g,' ').trim();
    }

    // --------------------------
    // 설명/요약 API 호출 (Generative API 호출 핸들러)
    async function callGenerativeAPI(modalTitleText, prompt){
      const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
      const payload = { contents: [ { parts: [ { text: prompt } ] } ] };

      let retryCount = 0; const maxRetries = 3;
      let response = null;
      while (retryCount < maxRetries) {
        try {
          response = await fetch(apiUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          if (response.ok) break;
          if (response.status === 429) { retryCount++; const delay = Math.pow(2, retryCount)*1000 + Math.random()*1000; await new Promise(r=>setTimeout(r, delay)); }
          else throw new Error(`API Error: ${response.status} ${response.statusText}`);
        } catch (err) {
          console.error('API call failed:', err);
          showModal("오류 발생", "API 호출 중 오류가 발생했습니다. 다시 시도해 주세요.");
          return;
        }
      }
      if (!response || !response.ok) { showModal("오류", "설명을 불러오는 데 실패했습니다. 잠시 후 다시 시도해 주세요."); return; }

      try {
        const data = await response.json();
        const content = data?.candidates?.[0]?.content?.parts?.[0]?.text || "응답을 가져오지 못했습니다.";
        showModal(modalTitleText, content);
      } catch (err) {
        console.error('Error processing response:', err);
        showModal("오류", "응답을 처리하는 중 오류가 발생했습니다.");
      }
    }

    // fetchExplanation + fetchSummary
    async function fetchExplanation(promptText, type){
      let prompt;
      if (type === 'simple') {
        prompt = `**명령:**다음 성경 용어/구절에 대해 모두 합쳐서 300자에서 500자 사이의 짧고 간결한 설명을 작성해 주세요. 만약에 선택어가 지명이름 또는 사람이름이면 (예: 단, 가나안, 하란, 브니엘, 세겜 등) 지명이면 인물을 검색하고 인물이면 지명을 검색해서 두 가지 다 설명해 주세요. 핵심 내용을 중심으로 요약해 주세요.\n**요청 용어/구절:** "${promptText}"\n**지침(요약):**- 지명/족속/민족: 거주지와 위치 간단 설명(필요하면 지도 언급)\n- 이름(인물): 이름의 뜻/주요활동/간단한 배경\n- 제사 도구/성물 등: 간단한 설명\n- 동물/식물/광물: 성경적 의미 간단 설명\n- 비교 가능한 개념(선택적): 핵심 비교 항목 간단 나열`;
      } else {
        prompt = `**명령:**다음 성경 용어/구절에 대해 성경적 관점에서 자세히 설명해 주세요. 답변은 모두 합쳐서 2,000자에서 3,000자 사이로 작성해 주세요. 필요하면 표 또는 간단한 지도를 포함하거나 참조해 주세요.\n**요청 용어/구절:** "${promptText}"\n**지침:**A. 지명, 족속, 민족, 나라: 지리적 위치, 역사적 배경, 성경 관련 사건\nB. 인물: 이름의 뜻, 주요 사건, 활동 지역\nC. 제사 도구/성물: 사용 목적 및 신학적 의미\nD. 동물/식물: 성경적 상징성\n출력은 한국어로 작성하세요.`;
      }
      showLoadingModal(false);
      await callGenerativeAPI('구절 설명', prompt);
    }

    async function fetchSummary(fullText, type){
      let prompt;
      if (type === 'simple') {
        prompt = `당신은 성경 주석가이자 성경 연구자입니다. 사용자가 선택한 성경 본문을 학문적·신학적 배경에서 분석하여, 핵심 주제와 메시지를 모두 합쳐서 300자에서 500자 사이로 간단하게 요약해 주세요. 불필요한 장황한 설명은 피하고 핵심 의미와 교훈에 집중하세요.\n선택된 성경 본문: "${fullText}"`;
      } else {
        prompt = `당신은 성경 주석가이자 성경 연구자입니다. 다음 성경 본문을 학문적·신학적 배경에서 분석하여, 본문의 주요 주제와 등장인물의 역할, 시대적 배경, 신학적 의미 등을 포함하여 자세히 설명해 주세요. 답변은 2,500자에서 3,500자 사이로 작성하세요.\n선택된 성경 본문: "${fullText}"`;
      }
      showLoadingModal(false);
      await callGenerativeAPI('본문 요약', prompt);
    }

    // --------------------------
    // updateSpeed
    function updateSpeed(){ audio.playbackRate = currentSpeed; speedDisplay.textContent = currentSpeed.toFixed(1) + 'x'; }

    // --------------------------
    // 선택관련 helper (외부에서 range 직접 설정 등)
    // selectionRange는 이미 클론된 Range를 보유하거나 null
    // handleSelectionChange()에서 selectedVerse 업데이트

    // --------------------------
    // selection 유지 보장: 유저가 터치/클릭 후 선택이 사라지는 경우, 이전에 저장된 selectionRange를 복원 시도
    // 이 파일에서 selectionRange는 선택 직후 저장되며, 버튼 클릭 등으로 선택이 사라지면 복원 시도함.

    // --------------------------
    // 추가 유틸 (폰트 표시)
    function updateFontSizeDisplay(){
      const cur = parseFloat(getComputedStyle(bibleTextEl).fontSize);
      fontSizeEl.textContent = Math.round(cur);
    }

    // --------------------------
    // 안전한 context: window 전역에서 사용할 수 있도록 일부 함수 노출 (선택사항)
    window.findString = findString;
    window.nextLocation = nextLocation;

    // --------------------------
    // --- ✅ 새 토글 버튼 로직 ---
  const progressContainer = document.querySelector('.progress-container');
  const speedControls = document.querySelector('.speed-controls');
  const volumeControl = document.querySelector('.volume-control');
  const showProgressBtn = document.getElementById('show-progress');
  const showSpeedBtn = document.getElementById('show-speed');
  const showVolumeBtn = document.getElementById('show-volume');

  let hideTimeout;

  function showOnly(target) {
    progressContainer.style.display = "none";
    speedControls.style.display = "none";
    volumeControl.style.display = "none";

    target.style.display = "flex";

    if (hideTimeout) clearTimeout(hideTimeout);
    hideTimeout = setTimeout(() => {
      target.style.display = "none";
    }, 10000);
  }

  showProgressBtn.addEventListener('click', () => showOnly(progressContainer));
  showSpeedBtn.addEventListener('click', () => showOnly(speedControls));
  showVolumeBtn.addEventListener('click', () => showOnly(volumeControl));
  </script>
</body>
</html>
